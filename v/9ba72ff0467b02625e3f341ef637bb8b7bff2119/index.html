<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Natalie R. Davidson" />
  <meta name="author" content="Casey S. Greene" />
  <meta name="dcterms.date" content="2021-06-04" />
  <meta name="keywords" content="markdown, publishing, manubot" />
  <title>Analysis of Nature news reveals gender and regional disparities in scientific coverage</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <!--
  Manubot generated metadata rendered from header-includes-template.html.
  Suggest improvements at https://github.com/manubot/manubot/blob/main/manubot/process/header-includes-template.html
  -->
  <meta name="dc.format" content="text/html" />
  <meta name="dc.title" content="Analysis of _Nature_ news reveals gender and regional disparities in scientific coverage" />
  <meta name="citation_title" content="Analysis of _Nature_ news reveals gender and regional disparities in scientific coverage" />
  <meta property="og:title" content="Analysis of _Nature_ news reveals gender and regional disparities in scientific coverage" />
  <meta property="twitter:title" content="Analysis of _Nature_ news reveals gender and regional disparities in scientific coverage" />
  <meta name="dc.date" content="2021-06-04" />
  <meta name="citation_publication_date" content="2021-06-04" />
  <meta name="dc.language" content="en-US" />
  <meta name="citation_language" content="en-US" />
  <meta name="dc.relation.ispartof" content="Manubot" />
  <meta name="dc.publisher" content="Manubot" />
  <meta name="citation_journal_title" content="Manubot" />
  <meta name="citation_technical_report_institution" content="Manubot" />
  <meta name="citation_author" content="Natalie R. Davidson" />
  <meta name="citation_author_institution" content="University of Colorado School of Medicine, Aurora, Colorado, United States of America; Center for Health AI" />
  <meta name="citation_author_orcid" content="0000-0002-1745-8072" />
  <meta name="twitter:creator" content="@n_rose_d" />
  <meta name="citation_author" content="Casey S. Greene" />
  <meta name="citation_author_institution" content="University of Colorado School of Medicine, Aurora, Colorado, United States of America; Center for Health AI" />
  <meta name="citation_author_orcid" content="0000-0001-8713-9213" />
  <meta name="twitter:creator" content="@GreeneScientist" />
  <link rel="canonical" href="https://greenelab.github.io/nature_news_manuscript/" />
  <meta property="og:url" content="https://greenelab.github.io/nature_news_manuscript/" />
  <meta property="twitter:url" content="https://greenelab.github.io/nature_news_manuscript/" />
  <meta name="citation_fulltext_html_url" content="https://greenelab.github.io/nature_news_manuscript/" />
  <meta name="citation_pdf_url" content="https://greenelab.github.io/nature_news_manuscript/manuscript.pdf" />
  <link rel="alternate" type="application/pdf" href="https://greenelab.github.io/nature_news_manuscript/manuscript.pdf" />
  <link rel="alternate" type="text/html" href="https://greenelab.github.io/nature_news_manuscript/v/9ba72ff0467b02625e3f341ef637bb8b7bff2119/" />
  <meta name="manubot_html_url_versioned" content="https://greenelab.github.io/nature_news_manuscript/v/9ba72ff0467b02625e3f341ef637bb8b7bff2119/" />
  <meta name="manubot_pdf_url_versioned" content="https://greenelab.github.io/nature_news_manuscript/v/9ba72ff0467b02625e3f341ef637bb8b7bff2119/manuscript.pdf" />
  <meta property="og:type" content="article" />
  <meta property="twitter:card" content="summary_large_image" />
  <link rel="icon" type="image/png" sizes="192x192" href="https://manubot.org/favicon-192x192.png" />
  <link rel="mask-icon" href="https://manubot.org/safari-pinned-tab.svg" color="#ad1457" />
  <meta name="theme-color" content="#ad1457" />
  <!-- end Manubot generated metadata -->
  
  <!-- pandoc-eqnos: equation style -->
  <style>
    .eqnos { display: inline-block; position: relative; width: 100%; }
    .eqnos br { display: none; }
    .eqnos-number { position: absolute; right: 0em; top: 50%; line-height: 0; }
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Analysis of <em>Nature</em> news reveals gender and regional disparities in scientific coverage</h1>
</header>
<p><small><em>
This manuscript
(<a href="https://greenelab.github.io/nature_news_manuscript/v/9ba72ff0467b02625e3f341ef637bb8b7bff2119/">permalink</a>)
was automatically generated
from <a href="https://github.com/greenelab/nature_news_manuscript/tree/9ba72ff0467b02625e3f341ef637bb8b7bff2119">greenelab/nature_news_manuscript@9ba72ff</a>
on June 4, 2021.
</em></small></p>
<h2 id="authors">Authors</h2>
<ul>
<li><p><strong>Natalie R. Davidson</strong><br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0002-1745-8072">0000-0002-1745-8072</a>
· <img src="images/github.svg" class="inline_icon" alt="GitHub icon" />
<a href="https://github.com/nrosed">nrosed</a>
· <img src="images/twitter.svg" class="inline_icon" alt="Twitter icon" />
<a href="https://twitter.com/n_rose_d">n_rose_d</a><br>
<small>
University of Colorado School of Medicine, Aurora, Colorado, United States of America; Center for Health AI
· Funded by Grant XXXXXXXX
</small></p></li>
<li><p><strong>Casey S. Greene</strong><br>
<img src="images/orcid.svg" class="inline_icon" alt="ORCID icon" />
<a href="https://orcid.org/0000-0001-8713-9213">0000-0001-8713-9213</a>
· <img src="images/github.svg" class="inline_icon" alt="GitHub icon" />
<a href="https://github.com/cgreene">cgreene</a>
· <img src="images/twitter.svg" class="inline_icon" alt="Twitter icon" />
<a href="https://twitter.com/GreeneScientist">GreeneScientist</a><br>
<small>
University of Colorado School of Medicine, Aurora, Colorado, United States of America; Center for Health AI
· Funded by Grant XXXXXXXX
</small></p></li>
</ul>
<h2 class="page_break_before" id="abstract">Abstract</h2>
<p>Scientific news coverage shapes the public’s view of the current state of scientific findings and legitimizes experts.
Through researching a story, journalists identify and interview a limited number of sources.
These sources may come from a journalist’s research or through recommendations by other scientists.
In either case, unconscious biases may influence who is identified as an expert to interview, possibly skewing the selection of interviewees.
We analyzed more than 22,000 news articles published by <em>Nature</em> to quantify possible disparities.
Our analysis considered three possible sources of bias: gender, name origin, and country affiliation.
To explore these sources of bias, we extracted cited authors’ names and affiliations, as well as extracted names of quoted speakers.
We then used the names to predict gender and name origin of the authors and speakers.
In our analysis, we found a bias towards male quotation, but quotation is trending toward equal representation at a faster rate than academic publishing.
Interestingly, we found that the gender disparity in quotes was column-dependent, with the “career-features” column reaching gender parity.
Our name origin analysis found a significant over-representation of names with Celtic/English origin and under-representation of names with an East Asian origin.
This finding was observed both in extracted quotes and citations, but dampened in citations.
Finally, we performed an analysis to identify how countries vary in the way that they’re described in the news.
We found a set of countries that are typically mentioned in the text of the article, but whose academic output is not highly cited, and their counterpart, a set of countries that are highly cited, but not commonly mentioned.
We found that the articles in which the less cited countries occur tend to have more agricultural terms, whereas articles including highly cited countries have broader scientific terms.
This discrepancy indicates a possible lack of regional diversity in the reporting of scientific output.</p>
<h2 id="introduction">Introduction</h2>
<p>News coverage of science shapes who both peers and the public consider a scientist and field expert.
This indication of legitimacy can either help recognize persons who are typically overlooked due to systemic biases or intensify biases.
Journalistic biases have been observed by journalists themselves <span class="citation" data-cites="9uN0d5DN CR5YHhw8 gud4dlat soMuDIhH">[<a href="#ref-9uN0d5DN" role="doc-biblioref">1</a>,<a href="#ref-CR5YHhw8" role="doc-biblioref">2</a>,<a href="#ref-gud4dlat" role="doc-biblioref">3</a>,<a href="#ref-soMuDIhH" role="doc-biblioref">4</a>]</span>, as well as by independent researchers <span class="citation" data-cites="zAQZlRnL 2svoFkJj 1onBkffH WRatNaGC DvlDdQFN 1718NkivT">[<a href="#ref-zAQZlRnL" role="doc-biblioref">5</a>,<a href="#ref-2svoFkJj" role="doc-biblioref">6</a>,<a href="#ref-1onBkffH" role="doc-biblioref">7</a>,<a href="#ref-WRatNaGC" role="doc-biblioref">8</a>,<a href="#ref-DvlDdQFN" role="doc-biblioref">9</a>,<a href="#ref-1718NkivT" role="doc-biblioref">10</a>]</span>.
Researchers found a gap between male and female speakers or quotes, with independent studies finding that between 17-40% of total subjects were female across multiple news outlets between 1985 and 2015 <span class="citation" data-cites="zAQZlRnL 2svoFkJj 1718NkivT">[<a href="#ref-zAQZlRnL" role="doc-biblioref">5</a>,<a href="#ref-2svoFkJj" role="doc-biblioref">6</a>,<a href="#ref-1718NkivT" role="doc-biblioref">10</a>]</span>.
One study found 27-35% of total subjects in science-related news were female between 1995 and 2010 <span class="citation" data-cites="1718NkivT">[<a href="#ref-1718NkivT" role="doc-biblioref">10</a>]</span>.
However, news coverage is not the only source of bias.
Both gender and racial disparities already exist in science as observed in differences in citation <span class="citation" data-cites="45G5HGj2 tTpbrlgZ">[<a href="#ref-45G5HGj2" role="doc-biblioref">11</a>,<a href="#ref-tTpbrlgZ" role="doc-biblioref">12</a>]</span>, funding <span class="citation" data-cites="hszzrI56 lomwLdKL hP9R3Quu n2VRCgZG">[<a href="#ref-hszzrI56" role="doc-biblioref">13</a>,<a href="#ref-lomwLdKL" role="doc-biblioref">14</a>,<a href="#ref-hP9R3Quu" role="doc-biblioref">15</a>,<a href="#ref-n2VRCgZG" role="doc-biblioref">16</a>]</span>, and publication rates <span class="citation" data-cites="NyXcBvbT 1Slc5L0l RC8qcaWy">[<a href="#ref-NyXcBvbT" role="doc-biblioref">17</a>,<a href="#ref-1Slc5L0l" role="doc-biblioref">18</a>,<a href="#ref-RC8qcaWy" role="doc-biblioref">19</a>]</span>.</p>
<p>Therefore, it is crucial to ensure that science coverage does not solely focus on a few well-known scientists but expands our shared view of an expert scientist.
One may believe that science coverage would simply reflect the most current and groundbreaking findings.
Still, there are many ways gender, racial, or regional biases can unknowingly seep into coverage.
In researching a story, a journalist will typically interview multiple scientists for their opinion, potentially asking for additional sources, allowing individual unconscious biases to skew scientific coverage broadly.
In addition, the repeated selection of a small set of field experts or the approach a journalist takes in establishing a new source may intensify existing biases <span class="citation" data-cites="11fb3ccQ4 gud4dlat soMuDIhH">[<a href="#ref-gud4dlat" role="doc-biblioref">3</a>,<a href="#ref-soMuDIhH" role="doc-biblioref">4</a>,<a href="#ref-11fb3ccQ4" role="doc-biblioref">20</a>]</span>.</p>
<p>While these biases may go unnoticed by an individual, analyzing a large corpus of articles can identify and quantify these biases and help guide institutional and individual self-reflection.
In the same vein as previous media studies, we seek to quantify gender and regional biases of news coverage.
Our study focuses solely on scientific news content, specifically news content published by <em>Nature</em>.
Since <em>Nature</em> also publishes research articles, this provides a natural estimated background rate for comparison.
Our goal is to identify quoted and cited scientists by analyzing the content and citations within all news articles from 2005 to 2020.
We further analyze if the coverage is biased beyond the current state of academic publishing by analyzing the authorship statistics across all <em>Nature</em> research articles across the same period.</p>
<p>Through our analysis of 22,094 news-related articles, we were able to identify &gt;120,000 quotes and &gt;10,000 citations with sufficient speaker or author information within the news content.
We then identified possible gender or regional biases using the extracted names.
We used computational methods to predict gender and identified a bias towards male quotes in news articles.
However, during the period that we examine the bias has decreased from being more extreme than in the research content of <em>Nature</em> to less extreme.
Furthermore, we identified that the speaker bias was dependent on article type; the “Career-Feature” column achieved gender parity in quoted speakers.
We also used computational methods to predict name origins and found a significant over-representation of names with Celtic/English origin and under-representation of names with an East Asian origin in both quotes and citations.</p>
<p>While we focused on scientific news coverage from <em>Nature</em>, our software can be repurposed to analyze other news text.
We hope that news publishers will welcome bias-audting systems to help identify journalistic blind spots.
However, auditing is only part of the solution; journalists and source recommenders must also change their source gathering patterns.
To help change these patterns, there exist guides <span class="citation" data-cites="11fb3ccQ4">[<a href="#ref-11fb3ccQ4" role="doc-biblioref">20</a>]</span>, databases <span class="citation" data-cites="TPNkhIbZ">[<a href="#ref-TPNkhIbZ" role="doc-biblioref">21</a>]</span>, and affinity groups <span class="citation" data-cites="11fb3ccQ4">[<a href="#ref-11fb3ccQ4" role="doc-biblioref">20</a>]</span> that can help us all expand our vision of who can be a field expert.</p>
<h2 id="methods">Methods</h2>
<h3 id="data-acquisition-and-processing">Data Acquisition and Processing</h3>
<h4 id="text-scraping">Text Scraping</h4>
<p>We scraped all text and metadata using the web-crawling framework Scrapy <span class="citation" data-cites="mfJiAqsK">[<a href="#ref-mfJiAqsK" role="doc-biblioref">23</a>]</span> (version 2.4.1).
We created three independent scrapy web spiders to process the news text, news citations, and research article metadata.
News articles were defined as all articles from 2005 to 2020 that were designated as “News”, “News-and-Views”, “News-Feature”, “Career-Column”, “Career-Feature”, “Technology-Feature”, and “Toolbox”.
Using the spider “target_year_crawl.py”, we scraped the title, author, and main text from all news articles.
We character normalized the main text by mapping visually identical Unicode codepoints to a single Unicode codepoint and stripping all non-Unicode characters.
Using an additional spider defined in “doi_crawl.py”, we scaped all citations within news articles.
For simplicity, we only considered citations with a DOI included in either text or a hyperlink in this spider.
Other possible forms of citations, e.g., titles, were not included.
The DOIs were then queried using the <em>Springer</em> API.
The spider “article_author_crawl.py” scraped all articles designated “Article” or “Letters” from all possible research articles.
We only scraped author names, author positions, and associated affiliations from research articles.
It should be noted that news article designations changed over time.</p>
<h4 id="corenlp">coreNLP</h4>
<p>After news articles were scraped and processed, the text was processed using the coreNLP pipeline <span class="citation" data-cites="RQkLuc5t">[<a href="#ref-RQkLuc5t" role="doc-biblioref">24</a>]</span> (version 4.2.0).
The main purpose for using coreNLP was to identify named entities related to countries and quoted speakers.
The full set of annotaters were: tokenize, ssplit, pos, lemma,ner, parse, coref, quote.
We used the “statistical” algorithm to perform coreference resolution.
All results were output to json format for further downstream processing.</p>
<h4 id="springer-api"><em>Springer</em> API</h4>
<p><em>Springer</em> was chosen over other publishers for multiple reasons: 1) it is a large publisher, second only to Elsevier; 2) it covers multiple subjects, in contrast to PubMed; 3) its API has a large daily query limit (5000/day); and 4) it provided more author affiliation information than found in Elsevier.
We generated a comparative background set for supplemental analysis with the <em>Springer</em> API by obtaining author information for research articles cited in the news.
We selected a random set of articles to generate the <em>Springer</em> background set.
These articles were the first 200 English language “Journal” articles returned by the <em>Springer</em> API for each month, resulting in 2400 articles per year for 2005 through 2020.
To get the author information for the cited articles, we queried the <em>Springer</em> API using the scraped DOI.
For both API query types, the author names, positions, and affiliations for each publication were stored and are available in “all_author_country.tsv” and “all_author_fullname.tsv”.</p>
<h3 id="name-normalization">Name Normalization</h3>
<p>Names were cast to lowercase and processed using the R package humaniformat <span class="citation" data-cites="dJT5FREG">[<a href="#ref-dJT5FREG" role="doc-biblioref">25</a>]</span>.
humaniformat identifies if names are reversed (Lastname, Firstname), as well as identifies middle names.
Since many last or first authorships may be non-names, we additionally filtered out any identified names if they partially or fully match any of the following terms: “consortium”, “group”, “initiative”, “team”, “collab”, “committee”, “center”, “program”, “author”, or “institute”.
Furthermore, since many articles only contain first and last name initials, we remove any names less than four letters with a “.” or “-”.
Finally, we only consider any remaining names of more than two characters.
We do this additional filtering to remove any web-scraping or coreNLP errors that only return partial names.</p>
<p>Since gender and origin predictions require the speaker’s full name, when possible, a longer name with minimal edit (Levenshtein) distance mentioned within the same article replaces the coreNLP predicted speaker.
The name with the smallest edit distance, where character deletions have zero cost, is defined as the matching name.
Character deletion was assigned a zero cost because we would like exact substring matches.
For example, the calculated cost, including a cost for character deletion, between John and John Steinberg is 10; without character deletion, it is 0.
Compared with the distance between John and Jane Doe, with character deletion cost, it is 7; without it is 2.
Furthermore, the identification of simultaneously cited and quoted speakers used this same name matching strategy.</p>
<h3 id="gender-analysis">Gender Analysis</h3>
<p>The quote extraction and attribution annotator from the coreNLP pipeline was employed to identify quotes and their associated speakers in the news article text.
In some cases, coreNLP could not identify an associated speaker’s name but instead assigned a gendered pronoun.
In these instances, we used the gender of the pronoun for the analysis.
The R package genderizeR <span class="citation" data-cites="cLM5pKQN">[<a href="#ref-cLM5pKQN" role="doc-biblioref">26</a>]</span>, a wrapper for the genderize.io API <span class="citation" data-cites="15Jxi2IvD">[<a href="#ref-15Jxi2IvD" role="doc-biblioref">27</a>]</span>, predicted the gender of authors and speakers.
We predicted a name as male using the first name with a minimum cutoff of 50%.
To reduce the number of queries made to genderize.io, a previously cached gender prediction from <span class="citation" data-cites="b1Ltmp3Z">[<a href="#ref-b1Ltmp3Z" role="doc-biblioref">28</a>]</span> was also used and can be found in the file “genderize.tsv”.
All first name predictions from this analysis are in the file “genderize_update.tsv”.
To estimate the gender gap for the quote gender analyses, we used the proportion of total quotes, not quoted speakers.
We used the proportion of quotes to measure speaker participation instead of only the diversity of speakers.
The specific formulas for a single year are shown in equations <a href="#eq:quote">1</a> and <a href="#eq:first-author">2</a>.
We did not consider any names where no prediction could be made or quotes where neither speaker nor gendered pronoun was associated.</p>
<p><span id="eq:quote" class="eqnos"><span class="math display">\[\textrm{Prop. Male Quotes} = \frac{|\textrm{Male Speaker Quotes}|} {|\textrm{Male or Female Speaker Quotes}|}\]</span><span class="eqnos-number">(1)</span></span></p>
<p><span id="eq:first-author" class="eqnos"><span class="math display">\[\textrm{Prop. Male First Authors} = \frac{|\textrm{Male First Authors}|} {|\textrm{Male or Female First Authors}|}\]</span><span class="eqnos-number">(2)</span></span></p>
<h3 id="name-origin-analysis">Name Origin Analysis</h3>
<p>We used the same quoted speakers as described in the previous section for the name origin analysis.
In addition, we also take all authors cited in a <em>Nature</em> news article.
In contrast to the gender prediction, we need to use the full name to predict name origin.
We submitted all extracted full names to Wiki-2019LSTM <span class="citation" data-cites="b1Ltmp3Z">[<a href="#ref-b1Ltmp3Z" role="doc-biblioref">28</a>]</span> to predict one of ten possible name origins: African, CelticEnglish, EastAsian, European, Greek, Hispanic, Jewish, ArabTurkPers, Nordic, and SouthAsia.
We set the highest probability origin as the resultant assignment.
Similar to the gender analyses, quote proportions were again directly compared against publication rates.
For citations, we calculated the proportion of overall news citations for a given year for each name origin, as exemplified in <a href="#eq:cite-origin">3</a> to calculate the citation rate for first authors with a Greek name origin.</p>
<p><span id="eq:cite-origin" class="eqnos"><span class="math display">\[\textrm{Prop. Greek } 1^\textrm{st} \textrm{ Author Citations} = \frac{| \textrm{Cited } 1^\textrm{st} \textrm{ Authors w/Greek Name Orig}|} {| \textrm{Cited } 1^\textrm{st} \textrm{ Authors w/any Name Orig}|}\]</span><span class="eqnos-number">(3)</span></span></p>
<h3 id="country-mention-proportions">Country Mention Proportions</h3>
<p>We estimated the prevalence of a country’s mentions by including all identified organizations, countries, states, or provinces from coreNLP’s named entity annotater.
We queried the resultant terms using OpenStreetMap <span class="citation" data-cites="1pU88qoC">[<a href="#ref-1pU88qoC" role="doc-biblioref">29</a>]</span> to identify the associated country with the term.
All terms that were identified in the text 25 or more times were visually inspected for correctness.
Hand-edited entries are denoted in the OpenStreetMap cache file “osm_cache.tsv” by the column “hand_edited”.
Still, this only accounts for less than 5% of the total entries.
Furthermore, country-associated terms identified by coreNLP may be ambiguous, causing OpenStreetMap to return incorrect locations.
Therefore, we count country mentions only if we find at least two unique country-associated terms in an article.
We calculate the mentioned rate as the proportion of country-specific mentions divided by the total articles for a particular year, as exemplified in <a href="#eq:mention">4</a> for calculating the mentioned rate for Mexico.</p>
<p><span id="eq:mention" class="eqnos"><span class="math display">\[\textrm{Prop. Mexico Mentions} = \frac{|\textrm{Articles with} \geq 2 \textrm{ unique Mexico-related terms}|} {|\textrm{All News Articles}|}\]</span><span class="eqnos-number">(4)</span></span></p>
<h3 id="country-citation-proportions">Country Citation Proportions</h3>
<p>To identify the citation rate of a particular country, we processed all authors’ affiliations for a specific article.
Since the affiliations could be in multiple formats, we again used OpenStreetMap to identify the country affiliation.
Additionally, we considered all affiliations for a single author.
We calculated a countries’ citation rate as the number of citations for a country divided by either the number of <em>Nature</em> research articles (<a href="#eq:mention-bg">5</a>) or the total number of papers cited by news articles for that year (<a href="#eq:mention-news">6</a>).
Shown below are example calculations for Colombia for a single year.</p>
<p><span id="eq:mention-bg" class="eqnos"><span class="math display">\[\textrm{Prop. CO Affil. in Nature} = \frac{|\textrm{Articles with} \geq 1 \textrm{ CO affil. in Nature}|} {|\textrm{All Nature Research Articles}|}\]</span><span class="eqnos-number">(5)</span></span></p>
<p><span id="eq:mention-news" class="eqnos"><span class="math display">\[\textrm{Prop. CO Affil. Citations} = \frac{|\textrm{Cited Articles in News with} \geq 1 \textrm{ CO affil.}|} {|\textrm{All Articles Cited in News}|}\]</span><span class="eqnos-number">(6)</span></span></p>
<h3 id="divergent-word-identification">Divergent Word Identification</h3>
<p>After calculating the citation and mention proportion for each country, we identified countries outlying in their comparative citation or mention rate.
Outlier detection was done by subtracting the citation and mention rates, then identifying which countries were in the top or bottom 5% from each year.
We only considered countries identified as either high citation (Set C) or high mention (Set M) across all years.
We did not consider any country that was in the top and bottom 5% in different years.
Additionally, we only considered a country if cited or mentioned five times in a single year.
Once we identified set C/M countries, we analyzed the word frequencies in all news articles where the set C/M country was mentioned but not cited.
We believe this would provide insight into content differences between set C/M countries.
Text from news articles in 2020 were not considered due to an excess of SARS-CoV-2 related terms.
Using the R package tidytext <span class="citation" data-cites="1B0FPaPWk">[<a href="#ref-1B0FPaPWk" role="doc-biblioref">30</a>]</span> we extracted tokens, removed stop words, and calculated the token frequencies across all articles.
We only consider tokens in set C/M articles if the token has been observed at least 100 times across all articles.
We then identify tokens that have the most significant ratio of usage between the two sets.
Since there are differences in the number of articles per country within each set, we calculated a token frequency within a set as the median frequency within each countries associated articles.
We calculated the resultant token ratio as the country normalized citation frequency to the country normalized mention frequency.
We assert that the term must be observed at least once in each set.</p>
<h3 id="bootstrap-estimations">Bootstrap Estimations</h3>
<p>For all analyses related to equations <a href="#eq:quote">1</a> - <a href="#eq:mention-news">6</a>, we independently selected 5000 bootstrap samples for each year.
We sampled with replacement of size equal to the cardinality of the complete set of interest.
Bootstrap estimates for equations <a href="#eq:quote">1</a> - <a href="#eq:mention-news">6</a> were performed by sampling the denominator set.
The 5th, 50th, and 95th quantiles across the estimates are reported as the lower, middle, and upper bounds.
For the divergent word analysis, due to computational constraints, we only took 1000 bootstrap samples.
The bootstrap estimates were taken by subsampling the news articles with replacement, each time recalculating the country-normalized token frequencies within each country set (C and M).
After the normalized frequencies within each country set were calculated, we calculated the ratio between country sets for each subsample with a pseudocount of 1 in the numerator and denominator, (C+1)/(M+1).
Again, the 5th, 50th, and 95th quantiles across the estimates are reported as the lower, middle, and upper bounds.</p>
<h2 id="results">Results</h2>
<div id="fig:fig1" class="fignos">
<figure>
<img src="https://github.com/nrosed/nature_news_disparities/raw/main/figure_notebooks/tmp_files/fig1_tmp/fig1_main.png" style="width:6in" alt="" /><figcaption><span>Figure 1:</span> <strong>Data and Processing Pipeline Overview</strong>
Panel A, left, depicts an example news article and the type of data extracted from the text.
Orange highlighted text depicts all named entities identified as either an organization, country, state, or province by the coreNLP pipeline.
The coreNLP pipeline also extracts all quotes and associated speakers.
A custom script described in section <a href="#methods">Methods</a> identifies all citations.
Panel A, right, charts the analyses done on the extracted names and locations from the news, research articles, and letters published by <em>Nature</em>.
Panel B shows the types and amounts of articles that we have used for analyses.</figcaption>
</figure>
</div>
<h3 id="creation-of-an-annotated-news-dataset">Creation of an Annotated News Dataset</h3>
<p>We have analyzed the text and citations of 22,094 news-related articles hosted on “www.nature.com”.
The articles span 15 years from 2005 to 2020, and seven article types: Career Column, Career Feature, News, News and Views, News Feature, Technology Feature, and Toolbox.
The text and citations were then uniformly processed as depicted in Figure <a href="#fig:fig1">1</a>a.
We scraped the text using the web-crawling framework Scrapy <span class="citation" data-cites="mfJiAqsK">[<a href="#ref-mfJiAqsK" role="doc-biblioref">23</a>]</span>, processed, and run through the coreNLP pipeline (<a href="#methods">Methods</a>).
From the coreNLP pipeline results, we wanted to identify two distinct data types to analyze, country mentions and quotes with their associated speakers.
To identify country mentions, we used the following named entities as possible mentions: “organizations”, “countries”, “states or provinces”.
We then mapped the named entity to a country prediction using OpenStreetMap <span class="citation" data-cites="1pU88qoC">[<a href="#ref-1pU88qoC" role="doc-biblioref">29</a>]</span>.
To identify quotes and speakers, we used the coreNLP quote extraction and attribution annotator.
We performed name normalization (<a href="#methods">Methods</a>) to identify the speaker’s full name for gender and name origin prediction.
We scraped the citations using an independent scraper to the text scraper.
All identified DOI’s were queried using the <em>Springer</em> API to attain author names, positions, and affiliations.</p>
<p>We used the author names, positions, and affiliations of Research articles and Letters published by <em>Nature</em> to perform comparative analyses.
Since the news articles of current science, the quoted speakers, mentioned countries, and cited authors should have a similar demographic makeup to contemporaneous <em>Nature</em> authorship.
The author metadata of research-related articles was analyzed over the same period as the news-related articles and totaled 13,414 articles.
Since the demographic makeup of authors published in <em>Nature</em> may not represent overall science authorship, we also analyzed 36,000 randomly selected <em>Springer</em>-published articles from English language journals over the same time.
The extracted author affiliations from both data sources were mapped to a country using OpenStreetMap.
Similarly, author names were uniformly processed and then used to predict both gender and name origin.</p>
<p>When considering all <em>Nature</em> articles, news and research, across all time, we find significant variability in the number of articles by type (Figure <a href="#fig:fig1">1</a>b).
The top three observed article frequencies are research (including letters and research), news, and news-and-views.
Since <em>Nature</em> merged letters and research articles in 2019, we combine them in our analysis.
The changing classification of article types may also explain temporal changes in news articles.
Over time, the frequency of news-related articles is decreasing; however, more specific article types are increasing.
We observe this in the introduction of two new categories, “Career-column” and “Career-feature” in 2017.
These articles were previously identified as “Features” articles before 2017 (https://www.nature.com/nature/articles?type=feature).</p>
<h3 id="quoted-speakers-are-more-often-male">Quoted Speakers are More Often Male</h3>
<div id="fig:fig2" class="fignos">
<figure>
<img src="https://github.com/nrosed/nature_news_disparities/raw/main/figure_notebooks/tmp_files/fig2_tmp/fig2_main.png" style="width:6in" alt="" /><figcaption><span>Figure 2:</span> <strong>Male bias is observed in news quotes but is dependent on article type</strong>
Panel A, left, depicts an example of the names extracted from quoted speakers in news articles and authors in research articles.
Panel A, right, highlighted the data types and processes used to analyze the gender of extracted names.
Panel B shows an overview of the number of quotes extracted for each article type.
Panel C depicts three trend lines: Purple: Proportion of quotes for an estimated male speaker; Light Blue: Proportion of first author articles from an estimated male author; Dark Blue: Proportion of last author articles from an estimated male author.
We observe that the proportion of estimated male quotes is steadily decreasing, most notably from 2017 onward.
This decreasing trend is not due to a change in quotes from the first or last authors, as observed in Panel D.
Panel D shows a consistent but slight bias towards quoting the last author of a cited article than the first author.
Instead, the observed downward trend of male quotes coincides with additional article types introduced in 2017.
Panel E depicts the frequency of quote by article type highlighting an increase in quotes from “Career-Feature” articles.
Panel E depicts that the quotes obtained in this article type have reached parity.
The colored bands represent a 95% confidence interval in all plots, and the point is the median calculated from 5,000 bootstrap samples.</figcaption>
</figure>
</div>
<p>To quantify the amount of gender bias in quotes, we analyzed the names of quoted speakers and compared them against the first and last authors of research articles.
While we could have analyzed the proportion of all quotes from a male speaker, we were interested in measuring the overall participation rates by gender.
Figure <a href="#fig:fig2">2</a> shows an overview of the process and example input data for this analysis.
This analysis relies upon accurate gender prediction of both authors and speakers.
To predict the gender of the speaker or author, we used the package genderizeR <span class="citation" data-cites="cLM5pKQN">[<a href="#ref-cLM5pKQN" role="doc-biblioref">26</a>]</span>, an R package wrapper to access the genderize.io API <span class="citation" data-cites="15Jxi2IvD">[<a href="#ref-15Jxi2IvD" role="doc-biblioref">27</a>]</span> to get binary gender predictions for each identified first name.
We, unfortunately, cannot identify non-binary gender expression with the tools we used.
To identify our binary gender prediction error rate, we created a benchmark data set of thirty randomly selected news articles; ten from each of the following years: 2005, 2010, 2015.
In these articles, we hand-annotated the quoted speakers and their assumed gender.
We then compared our hand-annotated gender prediction against the gender prediction after the entire scraping, coreNLP quote annotator, and genderizeR pipeline.
Using our hand-annotated prediction as ground truth, we correctly predicted a total of 42/55 female and 157/162 male names within the benchmark articles.
We found that the gender prediction had an accuracy of 0.914, with a Kappa statistic of 0.767 (Figure <a href="#fig:suppfig1">Supplemental 1</a>a).
After establishing a reasonable accuracy for gender prediction, we determined the rate of gendered quotes within articles.
We first examined the number of quotes identified within each news-related article (Figure <a href="#fig:fig2">2</a>b), totaling 121,684 quotes with 120,309 of them containing a gender prediction for the speaker.
Quote frequencies vary by article type.
The only article types in which there is a large discrepancy between the number of quotes and articles are “news-and-views” and “career-column.”
This discrepancy is expected in “news-and-views” since this article type typically is an overview of a specific scientific topic and rarely quotes authors.
Similarly, “career-column” is a perspective piece from a scientist who also rarely quotes other persons.</p>
<p>We then compared the number of male quotes to the number of male first and last authors published in <em>Nature</em> (Figure <a href="#fig:fig2">2</a>c).
We analyzed a total of 10,466 first authors and 10,494 last authors with a gender prediction.
As denoted by the red line, we find that both authorship and quotes are far from gender parity.
Additionally, we find a difference in author genders between first and last authors, with the last authors being more male-dominated.
Since <em>Nature</em> authorship may not represent scientific publishing as a whole, we also compared against a random selection of authors from English language journals published by <em>Springer</em> (Figure <a href="#fig:suppfig2">Supplemental 2</a>a).
We observed a larger gender gap between first and last authors in our selection of <em>Springer</em> articles; however, both first and last authors are much closer to parity than <em>Nature</em> authors.</p>
<p>In contrast to the relatively stable gender proportions of authorship, we find the rate of male quotes significantly decreases over time.
The male quote rate in 2005 is 87.6% (884/7103) and in 2020 is 70.1% (3911/5578).
From 2005-2010, we find the male quote rate is higher than the male last authorship rate, then slowly decreasing until it matches the male first authorship rate in 2018 and continues to trend downwards.
We then explored the possible reasons for this decrease.
First, we looked at changes in the rate of authorship position by quoted speakers (Figure <a href="#fig:fig2">2</a>d).
We were able to identify 10,167 quotes with an associated citation (4630 first author and 5537 last author quotes).
We found that quotes are slightly biased towards the last authors.
However, this rate does not change over time, and we do not believe this drives the downward trend.
We then analyzed the breakdown of gendered quotes by article type.
Interestingly, we found one article type, “career-feature” that has achieved gender parity in its quotes (Figure <a href="#fig:fig2">2</a>e and Figure <a href="#fig:suppfig2">Supplemental 2</a>b).
Since the introduction of this article, it has identified a total of 1,550 quotes (781 female and 769 male quotes) and has substantially pulled the overall quote gender ratio much closer to parity from 2018 onward.</p>
<h3 id="celtic-english-names-are-over-enriched-in-cited-and-quoted-persons-while-east-asian-names-are-under-enriched">Celtic English Names are over enriched in cited and quoted persons, while East Asian Names are under enriched</h3>
<div id="fig:fig3" class="fignos">
<figure>
<img src="https://github.com/nrosed/nature_news_disparities/raw/main/figure_notebooks/tmp_files/fig3_tmp/fig3_main.png" style="width:6in" alt="" /><figcaption><span>Figure 3:</span> <strong>Analysis of Quotes and Citations found Overrepresentation of Celtic/English and underrepresentation of East Asian names</strong>
Panel A, left, depicts an example of the names extracted from quoted speakers and citations found within news articles and authors in research articles.
Panel A, right, highlights the data types and processes used to analyze the origin of extracted names.
Panels B and D depicts nine trend lines, each representing a possible name origin.
Panels C and E depict two possible trend lines, comparing either cited last authors or quoted speakers against last authors of <em>Nature</em> research articles.
We observed that the overrepresentation of Celtic/English names is present both in citations and quotes.
Furthermore, the overrepresentation of East Asian names is also present both in citations and quotes.
We recapitulate this finding when comparing against an additional background of <em>Springer</em> published last authors (Figure <a href="#fig:suppfig3">Supplemental 3</a>)</figcaption>
</figure>
</div>
<p>To identify possible bias in name origin, we again used the extracted quoted speakers and last authors published in <em>Nature</em>.
In addition, we also identified the last authors of all articles cited by a news-related article.
All processed names were then inputted into Wiki2019-LSTM and used to assign one of nine possible name origins (<a href="#methods">Methods</a>).
Figure <a href="#fig:fig3">3</a>a displays a schematic of the data processing and example names used in this analysis.
We divided our analysis into two parts: firstly, looking at the number of cited last authors with a specific name origin overall cited last authors in a particular year.
Secondly, looking at the proportion of quotes from a speaker with a specific name origin overall quotes in a particular year.
We used the proportion of last authors in <em>Nature</em> with a specific name origin overall <em>Nature</em> articles in a particular year for both analyses.
Additionally, in our supplemental analyses, we compare against the last authorship in a random selection of <em>Springer</em> articles.
We find that the number of quotes dramatically outnumbers the number of authors and citations (Figure <a href="#fig:suppfig3">Supplemental 3</a>a).
Still, we believe that the total number of observations per data type across all years is sufficient for our analysis.
Minimum and median per data type: <em>Nature</em> articles, (682, 788); <em>Springer</em> articles, (1630, 1904); quotes, (4626, 6229); citations, (823, 1070).</p>
<p>In comparing the citation rate of last author name origins in news articles, we find most names are Celtic/English or European, both with a bootstrapped estimated citation rate between 26.2-42.5% (Figure <a href="#fig:fig3">3</a>b).
East Asian names are the third highest proportion of cited names, with a bootstrapped estimated citation rate between 8.3-19.0%.
All other name origins individually account for less than 7% of total cited authors.
To compare against the composition of the last authors in <em>Nature</em>, we compare the top three most frequent name origins (Figure <a href="#fig:fig3">3</a>c).
We find a slight over-enrichment for Celtic/English names and a small under-enrichment for East Asian names.
Furthermore, we find no significant difference for European or other name origins (Figure <a href="#fig:fig3">3</a>c, Figure <a href="#fig:suppfig3">Supplemental 3</a>b).
We also observed the Celtic/English over-enrichment and East Asian under-enrichment when considering our subset of <em>Springer</em> articles (Figure <a href="#fig:suppfig3">Supplemental 3</a>c).
In contrast to <em>Nature</em>, in our <em>Springer</em> articles, we see a significant difference in European names, with a growing over-enrichment.
Additionally, we see a significant difference in Arabic/Turkish/Persian, Hispanic, Jewish, and South Asian name frequencies between cited authors and <em>Springer</em> authors, however, the difference is lower than observed for Celtic/English and East Asian.</p>
<p>We then sought to see if quoted speaker replicated the cited authors’ over- and under-enrichment patterns.
We found a much stronger Celtic/English over-enrichment, with quotes from Celtic/English speakers at a much higher frequency than quotes from European speakers (Figure <a href="#fig:fig3">3</a>c).
Additionally, we also found a much stronger under-enrichment of quotes from East Asian speakers (Figure <a href="#fig:fig3">3</a>c), with never more than 7.8% of quotes even though they constitute between 8.3-19.0% of cited authors.
When we again compare against last authorship in <em>Nature</em>, we find the same patterns observed in the previously described citation analysis with all name origins except for East Asian and Celtic/English closely matching the background rate.
Similarly, we find the same patterns in quoted speakers when comparing against the <em>Springer</em> background as we did in the previous citation analysis (Figure <a href="#fig:suppfig3">Supplemental 3</a>e).</p>
<h3 id="content-of-science-coverage-differs-between-countries">Content of Science Coverage Differs between Countries</h3>
<div id="fig:fig4" class="fignos">
<figure>
<img src="https://github.com/nrosed/nature_news_disparities/raw/main/figure_notebooks/tmp_files/fig4_tmp/fig4_main.png" style="width:6in" alt="" /><figcaption><span>Figure 4:</span> <strong>Type of country representation in news articles differs depending on whether the or not country itself is the subject</strong>
Panel A, left, depicts an example of the country mentions extracted from the news article text and citations found within news articles and author affiliations in research articles.
Panel A, right, highlights the data types and processes used to analyze the countries cited or mentioned.
Panel B depicts the citation rate of the top ten most-cited countries over time.
Panel C depicts the citation rate of the top three most-cited countries (yellow) compared to that countries citation rate, as measured by author affiliation (grey).
Panel D is a heatmap depicting the yearly difference in citation and mention rate for a specific country.
We only depict countries with a consistent and significant difference across all years.
Each cell contains the difference between citation and mention rates, with red denoting the lower difference between mention and citation and green a more considerable difference.
The left annotation bar titled “median_M_C” is the median difference across all observed years.
The “Class” annotation column denotes the binarized set definition of each country, either “Cited” or “Mentioned”.
Panel E shows the top 15 words extracted from articles mentioning the countries depicted in Panel D, with the most significant proportional frequency between the two defined country sets.
The width of the bar depicts the log10(Frequency in Mentions / Frequency of Citations).</figcaption>
</figure>
</div>
<p>After finding name origin differences between cited and quoted persons, we wanted to determine if news articles 1) represent countries at different rates 2) vary in the language used to describe scientific content related to each country.
To do this analysis, we used three sources of information 1) country-related entities mentioned in the news text, 2) country affiliations of cited authors in news articles, 3) country affiliation of authors in <em>Nature</em> and Springer.
Figure <a href="#fig:fig4">4</a>a shows example input data and a schematic of the analysis.
We provide further processing details in <a href="#methods">Methods</a>.
First, we interrogated the country affiliations of cited authors.
We assigned an affiliation to a manuscript if any author has affiliation from a specific country.
Therefore a single manuscript may have multiple country affiliations.
We analyzed any possible country affiliation for an article due to limits imposed by the <em>Springer</em> API.
Affiliation query results from the <em>Springer</em> API return all country affiliations for a specific manuscript and are not linked to one particular author.</p>
<p>After post-processing, we analyzed a total of 12,853 articles and considered all authors within the article and their affiliations for this analysis.
We found that most cited articles have at least one author with an affiliation within the United States, followed by the United Kingdom, Germany, and France (Figure <a href="#fig:fig4">4</a>b).
Interestingly, we found a strong citation over-enrichment of many top-cited countries, but we found no evidence of under-enrichment by East Asian countries (Figure <a href="#fig:fig4">4</a>c, Figure <a href="#fig:suppfig4">Supplemental 4</a>a).
Next, we examined content differences between countries or groups of countries.
For example, we wanted to determine the extent to which a country was the subject (i.e., their scientific policies, environment, pollution) or the research being performed within that country was the subject.
To do this, we need to calculate the mention rate of each country.
To identify if a country was mentioned in an article, we started with all organizations, countries, states, or provinces identified by coreNLP’s named entity tagger.
We then linked all the identified region-related named entities to countries with OpenStreetMap.
Since there may be errors in both coreNLP and OpenStreetMap, we only assumed a country was mentioned when at least two unique entities mapped to the same country in a single article.
On a benchmark set, we identify 4 country identifications from a total of 59 country predictions were incorrect (Figure <a href="#fig:suppfig1">Supplemental 1</a>b,c).
When aggregating over articles, we find that 4/30 articles contain exactly one incorrect country mention (Figure <a href="#fig:suppfig1">Supplemental 1</a>b)</p>
<p>Once we calculated the mention rate and used the previously described citation rate, we identified countries with a consistent skew towards either a higher or lower mention to citation rate (Figure <a href="#fig:fig4">4</a>d and Figure <a href="#fig:suppfig4">Supplemental 4</a>b).
This is defined as countries where the difference between citation and mention rates is in the top or bottom 5% per year.
This outlier description allowed us to identify two sets of countries based on their citation and mention rates.
Those with a high relative citation to mention rate were: Germany, Netherlands, Japan, Spain, Denmark, Israel, Sweden, Switzerland, Belgium, Austria, China, South Korea, and Australia.
Those with a low relative citation to mention rate: Canada, Democratic Republic of the Congo, Chile, Indonesia, Russia, South Africa, Mexico, Brasil, Philippines, Colombia, and India.
We removed all countries that were in both the top or bottom 5% in different years, which excluded the United States, France, and the United Kingdom from consideration.</p>
<p>We then identified content differences between these two sets of countries by analyzing all of the main text from articles that mentioned and did not cite an author affiliated with each of the specified countries.
After properly identifying high-frequency words across the entire corpus, we identified the top 15 most discriminative terms of each country type (<a href="#methods">Methods</a>).
Interestingly, we identified that the words most linked with mentioned countries were related to environmental or extractive topics.
The top 5 terms were br, pesticide, dams, spores, and herd (Figure <a href="#fig:fig4">4</a>e, Figure <a href="#fig:suppfig4">Supplemental 4</a>c,d).
In contrast, we find that the words most related to countries with a higher citation than mention rate were science or research-related ones.
The top five terms were ips, entanglement, graphene, classical, and epigenetic.</p>
<h2 id="discussion">Discussion</h2>
<p>Scientific news coverage, unlike academic articles, should represent not only the current state of research-related disciplines but also the diversity of its readership.
News coverage is the conduit between the academic and public spheres, and consequently shapes the public’s view of science and scientists.
Though it would be best for news coverage to promote equitable representation, at a minimum news coverage should match the current rates of regional and gender participation in academia.
To test whether this last point was true, we analyzed over 10,000 news articles published by <em>Nature</em> to identify quoted and cited persons.
We then compared this to the authorship statistics from <em>Nature</em>’s research articles and a subset of <em>Springer</em>’s English language articles.</p>
<p>We first looked at possible gender biases in quotes and found a large, but decreasing, gender gap in all but one article type.
We found that the decreasing trend was largely driven by a single column, career-feature.
This column has an equal number of quotes from both genders showing that gender parity is possible in science-related news coverage.
In order to draw these conclusions, we performed an analysis examining the proportion of all identified quotes that were from a male speaker.
As a comparator, we analyzed the proportion of male authors, which similarly is a measure of scientific participation.
Using computational methods, we performed quote association and gender prediction.
We observe a strong bias towards male participation across both authorship and quotes.
We also identify a gender bias between first and last authors, previously shown in <span class="citation" data-cites="r5fYhK24 zp6LSf5E xqtsOPGC">[<a href="#ref-r5fYhK24" role="doc-biblioref">31</a>,<a href="#ref-zp6LSf5E" role="doc-biblioref">32</a>,<a href="#ref-xqtsOPGC" role="doc-biblioref">33</a>]</span>.
Interestingly, we found that while the rate of male quotes and male authorship are decreasing over time, quotation rate is decreasing faster than authorship rates.
We then tried to identify what drove the observed trend.
First or last authorship changes, which we anticipated to affect gendered quotation rates, did not drive the downward trend.
Despite first authors more commonly being female than last authors, first and last authors were quoted at comparable rates over time.
Instead, we found that column types were driving the trend, with career-feature reaching gender parity.</p>
<p>To further our analysis of possible coverage biases, we looked to biases in name origins of quoted and cited last authors across all the processed news articles.
Our findings provide additional support for previous studies that identified under-citation <span class="citation" data-cites="MpfuFcH2">[<a href="#ref-MpfuFcH2" role="doc-biblioref">34</a>]</span> and under-recognition <span class="citation" data-cites="b1Ltmp3Z">[<a href="#ref-b1Ltmp3Z" role="doc-biblioref">28</a>]</span> of East Asian persons.
Interestingly, we found that under-citation of East Asian persons to be less pronounced than under-quotation.
Overall, we find that most quotes and citations are from persons with Celtic/English or European name origins, followed by East Asian, with the remaining individual origins individually making up less than 10% of both citations or quotes.
Except Celtic/English (over-representation) and East Asian (under-representation), all name origins roughly match the expected academic background rate estimated by <em>Nature</em> last authorship.
We also found this same pattern in our <em>Springer</em> data set.</p>
<p>After observing name origin biases, we sought to identify a bias in the frequency or content of coverage across countries.
We first looked at possible citation biases for authors with specific country affiliations, and found that most manuscripts cited by <em>Nature</em> news have at least one author affiliated with the United States, United Kingdom, and Germany.
In contrast to the name origins results, the citation rate of Chinese affiliated authors was not significantly depleted.
Interestingly, we find the number of citations to articles with authors having affiliations in China is increasing at the same rate as <em>Springer</em> and <em>Nature</em> authorships.
Furthermore, the increased citation and last authorship rates of Chinese affiliated authors is most pronounced in comparison to all other countries within the top ten most cited.</p>
<p>We then focused on identifying whether the news content about a country focused on the scientific output from that country or the country itself as the scientific subject.
We postulated that a difference in citation and mention rates could indicate the difference in a news article’s subject matter.
To achieve this, we identified two sets of countries with a large and consistent difference in their citation and mention rates.
The top “Citation” countries were Germany, Netherlands, and Japan.
The top “Mention” countries were India, Colombia, and the Philippines.
We then found that these two sets of countries were discussed differently.
The resultant words for “Mention” countries were most related to agriculture; suggesting that the country was likely the article’s subject.
In contrast, the representative words for “Citation” countries were more diverse in topic, relating to biological, medical, and physics terms.
The difference in discriminative terms between the two country sets is evidence that the news content may focus more on research of a country as a subject than science that comes out of it.</p>
<p>Through our comprehensive analysis, we were able to identify how news coverage varies by country, name origin, and gender, and compare it to scientific publishing background rates.
While we found a significant gender bias, the rate of female representation in scientific news is increasing and outpacing authorships on scientific manuscripts.
Furthermore, we identified a significant depletion of quotes from scientists with an East Asian name origin and a significant but smaller depletion of authors with an East Asian name origin among the citations of news content.
Finally, we showed that coverage of specific countries might be biased by content, with the country’s scientific output being put in a more significant focus for some countries than the environmental aspects of other countries.
Previous anecdotal studies from journalists have shown that awareness of their bias can help them to reduce it <span class="citation" data-cites="CR5YHhw8 gud4dlat soMuDIhH">[<a href="#ref-CR5YHhw8" role="doc-biblioref">2</a>,<a href="#ref-gud4dlat" role="doc-biblioref">3</a>,<a href="#ref-soMuDIhH" role="doc-biblioref">4</a>]</span>.
Once a bias is identified an individual can seek resources to help them find and retain diverse sources, such as utilizing international expert databases like gage <span class="citation" data-cites="TPNkhIbZ">[<a href="#ref-TPNkhIbZ" role="doc-biblioref">21</a>]</span> and SheSource <span class="citation" data-cites="1CFcA44h9">[<a href="#ref-1CFcA44h9" role="doc-biblioref">22</a>]</span>.
Additional tips for journalists to achieve and maintain a diverse source pool is described by Christina Selby in the Open Notebook <span class="citation" data-cites="11fb3ccQ4">[<a href="#ref-11fb3ccQ4" role="doc-biblioref">20</a>]</span>.</p>
<p>While removing biases from their coverage should be a focus for editors and journalists, many journalists are limited by the persons who can respond to their requests for an interview or leads from prominent scientists.
Scientists themselves can also recommend junior researchers from diverse backgrounds, in contrast to referring journalists to well-established researchers that may already receive a lot of representation.
Furthermore, since news coverage is accountable to their readership, it presents the opportunity to represent scientific perspectives that are more diverse than observed in academic publishing.
We have shown that in at least one aspect that this is possible, as observed by the gender parity in quotes from the “career-features” column.
News outlets and referee scientists have a unique opportunity to shape the public and their peers’ perspectives on who is a scientific expert.
Their choice of coverage topics and interviewees could reflect a more diverse view of science and scientists and help to diminish existing biases in scientific research.</p>
<h3 id="data-and-resource-availability">Data and Resource availability</h3>
<p>This manuscript was written using Manubot <span class="citation" data-cites="YuJbg3zO">[<a href="#ref-YuJbg3zO" role="doc-biblioref">35</a>]</span> and is available on github: <a href="https://github.com/greenelab/nature_news_manuscript">manuscript repository link</a>.
All code and metadata is also available on github, <a href="https://github.com/greenelab/nature_news_disparities">full analysis repository link</a>, under a BSD 3-Clause License.
The code to generate all main and supplemental figures are available as R markdown documents within our main analysis github, in the following subfolder: <a href="https://github.com/greenelab/nature_news_disparities/tree/main/figure_notebooks">notebooks</a>.
Due to copyright, we are unable to provide the scraped data used in this analysis.
However, scraping code is available on our main analysis github, in the following subfolder: <a href="https://github.com/greenelab/nature_news_disparities/tree/main/nature_news_scraper">scraper</a>.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<!---
We would like to thank Jeffrey Perkel for spurring this line of research and providing thoughtful feedback throughout the course of this project. 
-->
<h2 class="page_break_before" id="supplemental-figures">Supplemental Figures</h2>
<div id="fig:suppfig1" class="fignos">
<figure>
<img src="https://github.com/nrosed/nature_news_disparities/raw/main/figure_notebooks/tmp_files/supp_fig1_tmp/supp_fig1.png" data-tag="Supplemental 1" style="width:6in" alt="" /><figcaption><span>Figure Supplemental 1:</span> <strong>Benchmark Data </strong>
Panel A, depicts the performance of gender prediction for pipeline-identified quoted speakers.
Panel B is a histogram of the number of articles that were falsely identified to mention a country by our processing pipeline.
Panels C shows the estimated versus true frequency of country mentions within our benchmark dataset. The red line denotes the x = y line.</figcaption>
</figure>
</div>
<div id="fig:suppfig2" class="fignos">
<figure>
<img src="https://github.com/nrosed/nature_news_disparities/raw/main/figure_notebooks/tmp_files/fig2_tmp/fig2_supp.png" data-tag="Supplemental 2" style="width:6in" alt="" /><figcaption><span>Figure Supplemental 2:</span> <strong>Male bias is also observed in news quotes when compared against <em>Springer</em> authorship</strong>
Panel A depicts three trend lines: Purple: Proportion of quotes for an estimated male speaker; Yellow: Proportion of first author articles from an estimated male author in <em>Springer</em>; Dark Mustard: Proportion of last author articles from an estimated male author in <em>Springer</em>.
We observe a larger gender difference between first and last authors in <em>Springer</em> articles, however the over male bias is less than observed in <em>Nature</em> research articles.
Panel B depicts the proportion of male quotes broken down by article type.
In all plots the colored bands represent a 95% confidence interval and the point is the median calculated from 5,000 bootstrap samples.</figcaption>
</figure>
</div>
<div id="fig:suppfig3" class="fignos">
<figure>
<img src="https://github.com/nrosed/nature_news_disparities/raw/main/figure_notebooks/tmp_files/fig3_tmp/fig3_supp.png" data-tag="Supplemental 3" style="width:6in" alt="" /><figcaption><span>Figure Supplemental 3:</span> <strong>Overrepresentation of Celtic/English names and underrepresentation of East Asian names is also found in <em>Springer</em> articles</strong>
Panel A, depicts the number of quotes, citations, or reasearch articles considered in the name origin analysis.
Panels B-D depicts ten plots, each for a possible name origin comparison against a background set.
Panel B and C compare the citation rate against <em>Nature</em> (b), or <em>Springer</em> (c) last author name origins.
Panel D and E compare the quote rate against <em>Nature</em> (d), or <em>Springer</em> (e) last author name origins.</figcaption>
</figure>
</div>
<div id="fig:suppfig4" class="fignos">
<figure>
<img src="https://github.com/nrosed/nature_news_disparities/raw/main/figure_notebooks/tmp_files/fig4_tmp/fig4_supp.png" data-tag="Supplemental 4" style="width:6in" alt="" /><figcaption><span>Figure Supplemental 4:</span> <strong>Analysis of Country representation</strong>
Panel A, depicts the citation rate for the top ten most cited articles by <em>Nature</em> news.
Each plot is a comparison between the citation rate (yellow), <em>Nature</em> author affiliation (grey), and <em>Springer</em> author affiliations (dark mustard).
Panel B depicts the top and bottom 5% of (mention rate - citation rate).
Each point represents a country - year pair.
Blue points are a country that is further considered to be a “Citation” or “Mention” country.
Panel C and D show the overall word frequencies of the 15 words with the largest ratio of frequencies between “Citation” (panel C) and “Mention” (panel D) countries.</figcaption>
</figure>
</div>
<h2 class="page_break_before" id="references">References</h2>
<!-- Explicitly insert bibliography here -->
<div id="refs" class="references hanging-indent" role="doc-bibliography">
<div id="ref-9uN0d5DN">
<p>1. <strong>The enduring whiteness of the American media | Howard French</strong> <br />
the Guardian<br />
(2016-05-25) <a href="http://www.theguardian.com/world/2016/may/25/enduring-whiteness-of-american-journalism">http://www.theguardian.com/world/2016/may/25/enduring-whiteness-of-american-journalism</a></p>
</div>
<div id="ref-CR5YHhw8">
<p>2. <strong>I Analyzed a Year of My Reporting for Gender Bias and This Is What I Found</strong> <br />
Adrienne LaFrance<br />
<em>Medium</em> (2013-09-30) <a href="https://medium.com/ladybits-on-medium/i-analyzed-a-year-of-my-reporting-for-gender-bias-and-this-is-what-i-found-a16c31e1cdf">https://medium.com/ladybits-on-medium/i-analyzed-a-year-of-my-reporting-for-gender-bias-and-this-is-what-i-found-a16c31e1cdf</a></p>
</div>
<div id="ref-gud4dlat">
<p>3. <strong>I Analyzed a Year of My Reporting for Gender Bias (Again)</strong> <br />
Adrienne LaFrance<br />
<em>The Atlantic</em> (2016-02-17) <a href="https://www.theatlantic.com/technology/archive/2016/02/gender-diversity-journalism/463023/">https://www.theatlantic.com/technology/archive/2016/02/gender-diversity-journalism/463023/</a></p>
</div>
<div id="ref-soMuDIhH">
<p>4. <strong>I Spent Two Years Trying to Fix the Gender Imbalance in My Stories</strong> <br />
Ed Yong<br />
<em>The Atlantic</em> (2018-02-06) <a href="https://www.theatlantic.com/science/archive/2018/02/i-spent-two-years-trying-to-fix-the-gender-imbalance-in-my-stories/552404/">https://www.theatlantic.com/science/archive/2018/02/i-spent-two-years-trying-to-fix-the-gender-imbalance-in-my-stories/552404/</a></p>
</div>
<div id="ref-zAQZlRnL">
<p>5. <strong>A Paper Ceiling</strong> <br />
Eran Shor, Arnout van de Rijt, Alex Miltsov, Vivek Kulkarni, Steven Skiena<br />
<em>American Sociological Review</em> (2015-09-30) <a href="https://doi.org/f7tzps">https://doi.org/f7tzps</a> <br />
DOI: <a href="https://doi.org/10.1177/0003122415596999">10.1177/0003122415596999</a></p>
</div>
<div id="ref-2svoFkJj">
<p>6. <strong>Time Trends in Printed News Coverage of Female Subjects, 1880–2008</strong> <br />
Eran Shor, Arnout van de Rijt, Charles Ward, Aharon Blank-Gomel, Steven Skiena<br />
<em>Journalism Studies</em> (2013-09-12) <a href="https://doi.org/gj3z8b">https://doi.org/gj3z8b</a> <br />
DOI: <a href="https://doi.org/10.1080/1461670x.2013.834149">10.1080/1461670x.2013.834149</a></p>
</div>
<div id="ref-1onBkffH">
<p>7. <strong>Women and news: A long and winding road</strong> <br />
Karen Ross, Cynthia Carter<br />
<em>Media, Culture &amp; Society</em> (2011-11-22) <a href="https://doi.org/ccxhvz">https://doi.org/ccxhvz</a> <br />
DOI: <a href="https://doi.org/10.1177/0163443711418272">10.1177/0163443711418272</a></p>
</div>
<div id="ref-WRatNaGC">
<p>8. <strong>Women Are Seen More than Heard in Online Newspapers</strong> <br />
Sen Jia, Thomas Lansdall-Welfare, Saatviga Sudhahar, Cynthia Carter, Nello Cristianini<br />
<em>PLOS ONE</em> (2016-02-03) <a href="https://doi.org/f8q47g">https://doi.org/f8q47g</a> <br />
DOI: <a href="https://doi.org/10.1371/journal.pone.0148434">10.1371/journal.pone.0148434</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/26840432">26840432</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4740422">PMC4740422</a></p>
</div>
<div id="ref-DvlDdQFN">
<p>9. <strong>Lack of female sources in NY Times front-page stories highlights need for change</strong> <br />
Poynter<br />
(2013-07-16) <a href="https://www.poynter.org/reporting-editing/2013/lack-of-female-sources-in-new-york-times-stories-spotlights-need-for-change/">https://www.poynter.org/reporting-editing/2013/lack-of-female-sources-in-new-york-times-stories-spotlights-need-for-change/</a></p>
</div>
<div id="ref-1718NkivT">
<p>10. <strong>Who Makes the News | GMMP 2015 Reports</strong> <a href="https://whomakesthenews.org/gmmp-2015-reports/">https://whomakesthenews.org/gmmp-2015-reports/</a></p>
</div>
<div id="ref-45G5HGj2">
<p>11. <strong>Men Set Their Own Cites High: Gender and Self-citation across Fields and over Time</strong> <br />
Molly M. King, Carl T. Bergstrom, Shelley J. Correll, Jennifer Jacquet, Jevin D. West<br />
<em>Socius: Sociological Research for a Dynamic World</em> (2017-12-08) <a href="https://doi.org/ddzq">https://doi.org/ddzq</a> <br />
DOI: <a href="https://doi.org/10.1177/2378023117738903">10.1177/2378023117738903</a></p>
</div>
<div id="ref-tTpbrlgZ">
<p>12. <strong>Bibliometrics: Global gender disparities in science</strong> <br />
Vincent Larivière, Chaoqun Ni, Yves Gingras, Blaise Cronin, Cassidy R. Sugimoto<br />
<em>Nature</em> (2013-12-11) <a href="https://doi.org/qgf">https://doi.org/qgf</a> <br />
DOI: <a href="https://doi.org/10.1038/504211a">10.1038/504211a</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/24350369">24350369</a></p>
</div>
<div id="ref-hszzrI56">
<p>13. <strong>Fund Black scientists</strong> <br />
Kelly R. Stevens, Kristyn S. Masters, P. I. Imoukhuede, Karmella A. Haynes, Lori A. Setton, Elizabeth Cosgriff-Hernandez, Muyinatu A. Lediju Bell, Padmini Rangamani, Shelly E. Sakiyama-Elbert, Stacey D. Finley, … Omolola Eniola-Adefeso<br />
<em>Cell</em> (2021-02) <a href="https://doi.org/ghvqv5">https://doi.org/ghvqv5</a> <br />
DOI: <a href="https://doi.org/10.1016/j.cell.2021.01.011">10.1016/j.cell.2021.01.011</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/33503447">33503447</a></p>
</div>
<div id="ref-lomwLdKL">
<p>14. <strong>NIH peer review: Criterion scores completely account for racial disparities in overall impact scores</strong> <br />
Elena A. Erosheva, Sheridan Grant, Mei-Ching Chen, Mark D. Lindner, Richard K. Nakamura, Carole J. Lee<br />
<em>Science Advances</em> (2020-06-03) <a href="https://doi.org/gjnjbz">https://doi.org/gjnjbz</a> <br />
DOI: <a href="https://doi.org/10.1126/sciadv.aaz4868">10.1126/sciadv.aaz4868</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32537494">32537494</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7269672">PMC7269672</a></p>
</div>
<div id="ref-hP9R3Quu">
<p>15. <strong>Topic choice contributes to the lower rate of NIH awards to African-American/black scientists</strong> <br />
Travis A. Hoppe, Aviva Litovitz, Kristine A. Willis, Rebecca A. Meseroll, Matthew J. Perkins, B. Ian Hutchins, Alison F. Davis, Michael S. Lauer, Hannah A. Valantine, James M. Anderson, George M. Santangelo<br />
<em>Science Advances</em> (2019-10-09) <a href="https://doi.org/gghp8t">https://doi.org/gghp8t</a> <br />
DOI: <a href="https://doi.org/10.1126/sciadv.aaw7238">10.1126/sciadv.aaw7238</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31633016">31633016</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6785250">PMC6785250</a></p>
</div>
<div id="ref-n2VRCgZG">
<p>16. <strong>SOCIOLOGY: The Gender Gap in NIH Grant Applications</strong> <br />
T. J. Ley, B. H. Hamilton<br />
<em>Science</em> (2008-12-05) <a href="https://doi.org/frdj6k">https://doi.org/frdj6k</a> <br />
DOI: <a href="https://doi.org/10.1126/science.1165878">10.1126/science.1165878</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/19056961">19056961</a></p>
</div>
<div id="ref-NyXcBvbT">
<p>17. <strong>Disparities in publication patterns by gender, race and ethnicity based on a survey of a random sample of authors</strong> <br />
Allison L. Hopkins, James W. Jawitz, Christopher McCarty, Alex Goldman, Nandita B. Basu<br />
<em>Scientometrics</em> (2012-11-10) <a href="https://doi.org/gffmpv">https://doi.org/gffmpv</a> <br />
DOI: <a href="https://doi.org/10.1007/s11192-012-0893-4">10.1007/s11192-012-0893-4</a></p>
</div>
<div id="ref-1Slc5L0l">
<p>18. <strong>The Diversity–Innovation Paradox in Science</strong> <br />
Bas Hofstra, Vivek V. Kulkarni, Sebastian Munoz-Najar Galvez, Bryan He, Dan Jurafsky, Daniel A. McFarland<br />
<em>Proceedings of the National Academy of Sciences</em> (2020-04-28) <a href="https://doi.org/ggskr7">https://doi.org/ggskr7</a> <br />
DOI: <a href="https://doi.org/10.1073/pnas.1915378117">10.1073/pnas.1915378117</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32291335">32291335</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7196824">PMC7196824</a></p>
</div>
<div id="ref-RC8qcaWy">
<p>19. <strong>Last Place? The Intersection of Ethnicity, Gender, and Race in Biomedical Authorship</strong> <br />
Gerald Marschke, Allison Nunez, Bruce A. Weinberg, Huifeng Yu<br />
<em>AEA Papers and Proceedings</em> (2018-05-01) <a href="https://doi.org/gjg9k8">https://doi.org/gjg9k8</a> <br />
DOI: <a href="https://doi.org/10.1257/pandp.20181111">10.1257/pandp.20181111</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/30197432">30197432</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6124503">PMC6124503</a></p>
</div>
<div id="ref-11fb3ccQ4">
<p>20. <strong>Including Diverse Voices in Science Stories</strong> <br />
Christina Selby<br />
<em>The Open Notebook</em> (2016-08-23) <a href="https://www.theopennotebook.com/2016/08/23/including-diverse-voices-in-science-stories/">https://www.theopennotebook.com/2016/08/23/including-diverse-voices-in-science-stories/</a></p>
</div>
<div id="ref-TPNkhIbZ">
<p>21. <strong>gage. Discover Brilliance</strong> <a href="https://gage.500womenscientists.org/">https://gage.500womenscientists.org/</a></p>
</div>
<div id="ref-1CFcA44h9">
<p>22. <strong>WMC SheSource - Women’s Media Center</strong> <a href="https://www.womensmediacenter.com/shesource">https://www.womensmediacenter.com/shesource</a></p>
</div>
<div id="ref-mfJiAqsK">
<p>23. <strong>Scrapy | A Fast and Powerful Scraping and Web Crawling Framework</strong> <a href="https://scrapy.org/">https://scrapy.org/</a></p>
</div>
<div id="ref-RQkLuc5t">
<p>24. <strong>The Stanford CoreNLP Natural Language Processing Toolkit</strong> <br />
Christopher Manning, Mihai Surdeanu, John Bauer, Jenny Finkel, Steven Bethard, David McClosky<br />
<em>Association for Computational Linguistics (ACL)</em> (2014) <a href="https://doi.org/gf3xhp">https://doi.org/gf3xhp</a> <br />
DOI: <a href="https://doi.org/10.3115/v1/p14-5010">10.3115/v1/p14-5010</a></p>
</div>
<div id="ref-dJT5FREG">
<p>25. <strong>humaniformat: A Parser for Human Names</strong> <a href="https://CRAN.R-project.org/package=humaniformat">https://CRAN.R-project.org/package=humaniformat</a></p>
</div>
<div id="ref-cLM5pKQN">
<p>26. <strong>Gender Prediction Methods Based on First Names with genderizeR</strong> <br />
Kamil Wais<br />
<em>The R Journal</em> (2016) <a href="https://doi.org/gf4zqx">https://doi.org/gf4zqx</a> <br />
DOI: <a href="https://doi.org/10.32614/rj-2016-002">10.32614/rj-2016-002</a></p>
</div>
<div id="ref-15Jxi2IvD">
<p>27. <strong>Genderize.io | Determine the gender of a name</strong> <a href="https://genderize.io/">https://genderize.io/</a></p>
</div>
<div id="ref-b1Ltmp3Z">
<p>28. <strong>Analysis of ISCB honorees and keynotes reveals disparities</strong> <br />
Trang T. Le, Daniel S. Himmelstein, Ariel A. Hippen Anderson, Matthew R. Gazzara, Casey S. Greene<br />
<em>Cold Spring Harbor Laboratory</em> (2020-09-22) <a href="https://doi.org/ggr64p">https://doi.org/ggr64p</a> <br />
DOI: <a href="https://doi.org/10.1101/2020.04.14.927251">10.1101/2020.04.14.927251</a></p>
</div>
<div id="ref-1pU88qoC">
<p>29. <strong>OpenStreetMap</strong> <br />
OpenStreetMap<br />
<a href="https://www.openstreetmap.org/">https://www.openstreetmap.org/</a></p>
</div>
<div id="ref-1B0FPaPWk">
<p>30. <strong>Text Mining using “dplyr”, “ggplot2”, and Other Tidy Tools [R package tidytext version 0.3.1]</strong> (2021-04-10) <a href="https://CRAN.R-project.org/package=tidytext">https://CRAN.R-project.org/package=tidytext</a></p>
</div>
<div id="ref-r5fYhK24">
<p>31. <strong>Time’s up for journal gender bias.</strong> <br />
Nina Schwalbe, Jennifer Fearon<br />
<em>Lancet (London, England)</em> (2018-06-30) <a href="https://www.ncbi.nlm.nih.gov/pubmed/30070216">https://www.ncbi.nlm.nih.gov/pubmed/30070216</a> <br />
DOI: <a href="https://doi.org/10.1016/s0140-6736(18)31140-1">10.1016/s0140-6736(18)31140-1</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/30070216">30070216</a></p>
</div>
<div id="ref-zp6LSf5E">
<p>32. <strong>Does academic authorship reflect gender bias in pediatric surgery? An analysis of the Journal of Pediatric Surgery, 2007–2017</strong> <br />
Alexandra F. Marrone, Loren Berman, Mary L. Brandt, David H. Rothstein<br />
<em>Journal of Pediatric Surgery</em> (2020-10) <a href="https://doi.org/gj7mc9">https://doi.org/gj7mc9</a> <br />
DOI: <a href="https://doi.org/10.1016/j.jpedsurg.2020.05.020">10.1016/j.jpedsurg.2020.05.020</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/32563536">32563536</a></p>
</div>
<div id="ref-xqtsOPGC">
<p>33. <strong>Gender Trends in Authorship in Psychiatry Journals From 2008 to 2018</strong> <br />
Kamber L. Hart, Sophia Frangou, Roy H. Perlis<br />
<em>Biological Psychiatry</em> (2019-10) <a href="https://doi.org/gjtjzz">https://doi.org/gjtjzz</a> <br />
DOI: <a href="https://doi.org/10.1016/j.biopsych.2019.02.010">10.1016/j.biopsych.2019.02.010</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/30935668">30935668</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6699930">PMC6699930</a></p>
</div>
<div id="ref-MpfuFcH2">
<p>34. <strong>Racial and ethnic imbalance in neuroscience reference lists and intersections with gender</strong> <br />
Maxwell A. Bertolero, Jordan D. Dworkin, Sophia U. David, Claudia López Lloreda, Pragya Srivastava, Jennifer Stiso, Dale Zhou, Kafui Dzirasa, Damien A. Fair, Antonia N. Kaczkurkin, … Danielle S. Bassett<br />
<em>Cold Spring Harbor Laboratory</em> (2020-10-12) <a href="https://doi.org/gj7mdc">https://doi.org/gj7mdc</a> <br />
DOI: <a href="https://doi.org/10.1101/2020.10.12.336230">10.1101/2020.10.12.336230</a></p>
</div>
<div id="ref-YuJbg3zO">
<p>35. <strong>Open collaborative writing with Manubot</strong> <br />
Daniel S. Himmelstein, Vincent Rubinetti, David R. Slochower, Dongbo Hu, Venkat S. Malladi, Casey S. Greene, Anthony Gitter<br />
<em>PLOS Computational Biology</em> (2019-06-24) <a href="https://doi.org/c7np">https://doi.org/c7np</a> <br />
DOI: <a href="https://doi.org/10.1371/journal.pcbi.1007128">10.1371/journal.pcbi.1007128</a> · PMID: <a href="https://www.ncbi.nlm.nih.gov/pubmed/31233491">31233491</a> · PMCID: <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6611653">PMC6611653</a></p>
</div>
</div>
<!-- default theme -->

<style>
  /* import google fonts */
  @import url("https://fonts.googleapis.com/css?family=Open+Sans:400,600,700");
  @import url("https://fonts.googleapis.com/css?family=Source+Code+Pro");

  /* -------------------------------------------------- */
  /* global */
  /* -------------------------------------------------- */

  /* all elements */
  * {
    /* force sans-serif font unless specified otherwise */
    font-family: "Open Sans", "Helvetica", sans-serif;

    /* prevent text inflation on some mobile browsers */
    -webkit-text-size-adjust: none !important;
    -moz-text-size-adjust: none !important;
    -o-text-size-adjust: none !important;
    text-size-adjust: none !important;
  }

  @media only screen {
    /* "page" element */
    body {
      position: relative;
      box-sizing: border-box;
      font-size: 12pt;
      line-height: 1.5;
      max-width: 8.5in;
      margin: 20px auto;
      padding: 40px;
      border-radius: 5px;
      border: solid 1px #bdbdbd;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
      background: #ffffff;
    }
  }

  /* when on screen < 8.5in wide */
  @media only screen and (max-width: 8.5in) {
    /* "page" element */
    body {
      padding: 20px;
      margin: 0;
      border-radius: 0;
      border: none;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05) inset;
      background: none;
    }
  }

  /* -------------------------------------------------- */
  /* headings */
  /* -------------------------------------------------- */

  /* all headings */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    margin: 20px 0;
    padding: 0;
    font-weight: bold;
  }

  /* biggest heading */
  h1 {
    margin: 40px 0;
    text-align: center;
  }

  /* second biggest heading */
  h2 {
    margin-top: 30px;
    padding-bottom: 5px;
    border-bottom: solid 1px #bdbdbd;
  }

  /* heading font sizes */
  h1 {
    font-size: 2em;
  }
  h2 {
    font-size: 1.5em;
  }
  h3 {
    font-size: 1.35em;
  }
  h4 {
    font-size: 1.25em;
  }
  h5 {
    font-size: 1.15em;
  }
  h6 {
    font-size: 1em;
  }

  /* -------------------------------------------------- */
  /* manuscript header */
  /* -------------------------------------------------- */

  /* manuscript title */
  header > h1 {
    margin: 0;
  }

  /* manuscript title caption text (ie "automatically generated on") */
  header + p {
    text-align: center;
    margin-top: 10px;
  }

  /* -------------------------------------------------- */
  /* text elements */
  /* -------------------------------------------------- */

  /* links */
  a {
    color: #2196f3;
    overflow-wrap: break-word;
  }

  /* superscripts and subscripts */
  sub,
  sup {
    /* prevent from affecting line height */
    line-height: 0;
  }

  /* unordered and ordered lists*/
  ul,
  ol {
    padding-left: 20px;
  }

  /* class for styling text semibold */
  .semibold {
    font-weight: 600;
  }

  /* class for styling elements horizontally left aligned */
  .left {
    display: block;
    text-align: left;
    margin-left: auto;
    margin-right: 0;
    justify-content: left;
  }

  /* class for styling elements horizontally centered */
  .center {
    display: block;
    text-align: center;
    margin-left: auto;
    margin-right: auto;
    justify-content: center;
  }

  /* class for styling elements horizontally right aligned */
  .right {
    display: block;
    text-align: right;
    margin-left: 0;
    margin-right: auto;
    justify-content: right;
  }

  /* -------------------------------------------------- */
  /* section elements */
  /* -------------------------------------------------- */

  /* horizontal divider line */
  hr {
    border: none;
    height: 1px;
    background: #bdbdbd;
  }

  /* paragraphs, horizontal dividers, figures, tables, code */
  p,
  hr,
  figure,
  table,
  pre {
    /* treat all as "paragraphs", with consistent vertical margins */
    margin-top: 20px;
    margin-bottom: 20px;
  }

  /* -------------------------------------------------- */
  /* figures */
  /* -------------------------------------------------- */

  /* figure */
  figure {
    max-width: 100%;
    margin-left: auto;
    margin-right: auto;
  }

  /* figure caption */
  figcaption {
    padding: 0;
    padding-top: 10px;
  }

  /* figure image element */
  figure > img,
  figure > svg {
    max-width: 100%;
    display: block;
    margin-left: auto;
    margin-right: auto;
  }

  /* figure auto-number */
  img + figcaption > span:first-of-type,
  svg + figcaption > span:first-of-type {
    font-weight: bold;
    margin-right: 5px;
  }

  /* -------------------------------------------------- */
  /* tables */
  /* -------------------------------------------------- */

  /* table */
  table {
    border-collapse: collapse;
    border-spacing: 0;
    width: 100%;
    margin-left: auto;
    margin-right: auto;
  }

  /* table cells */
  th,
  td {
    border: solid 1px #bdbdbd;
    padding: 10px;
    /* squash table if too wide for page by forcing line breaks */
    overflow-wrap: break-word;
    word-break: break-word;
  }

  /* header row and even rows */
  th,
  tr:nth-child(2n) {
    background-color: #fafafa;
  }

  /* odd rows */
  tr:nth-child(2n + 1) {
    background-color: #ffffff;
  }

  /* table caption */
  caption {
    text-align: left;
    padding: 0;
    padding-bottom: 10px;
  }

  /* table auto-number */
  table > caption > span:first-of-type,
  div.table_wrapper > table > caption > span:first-of-type {
    font-weight: bold;
    margin-right: 5px;
  }

  /* -------------------------------------------------- */
  /* code */
  /* -------------------------------------------------- */

  /* multi-line code block */
  pre {
    padding: 10px;
    background-color: #eeeeee;
    color: #000000;
    border-radius: 5px;
    break-inside: avoid;
    text-align: left;
  }

  /* inline code, ie code within normal text */
  :not(pre) > code {
    padding: 0 4px;
    background-color: #eeeeee;
    color: #000000;
    border-radius: 5px;
  }

  /* code text */
  /* apply all children, to reach syntax highlighting sub-elements */
  code,
  code * {
    /* force monospace font */
    font-family: "Source Code Pro", "Courier New", monospace;
  }

  /* -------------------------------------------------- */
  /* quotes */
  /* -------------------------------------------------- */

  /* quoted text */
  blockquote {
    margin: 0;
    padding: 0;
    border-left: 4px solid #bdbdbd;
    padding-left: 16px;
    break-inside: avoid;
  }

  /* -------------------------------------------------- */
  /* banners */
  /* -------------------------------------------------- */

  /* info banners */
  .banner {
    box-sizing: border-box;
    display: block;
    position: relative;
    width: 100%;
    margin-top: 20px;
    margin-bottom: 20px;
    padding: 20px;
    text-align: center;
  }

  /* paragraph in banner */
  .banner > p {
    margin: 0;
  }

  /* -------------------------------------------------- */
  /* highlight colors */
  /* -------------------------------------------------- */

  .white {
    background: #ffffff;
  }
  .lightgrey {
    background: #eeeeee;
  }
  .grey {
    background: #757575;
  }
  .darkgrey {
    background: #424242;
  }
  .black {
    background: #000000;
  }
  .lightred {
    background: #ffcdd2;
  }
  .lightyellow {
    background: #ffecb3;
  }
  .lightgreen {
    background: #dcedc8;
  }
  .lightblue {
    background: #e3f2fd;
  }
  .lightpurple {
    background: #f3e5f5;
  }
  .red {
    background: #f44336;
  }
  .orange {
    background: #ff9800;
  }
  .yellow {
    background: #ffeb3b;
  }
  .green {
    background: #4caf50;
  }
  .blue {
    background: #2196f3;
  }
  .purple {
    background: #9c27b0;
  }
  .white,
  .lightgrey,
  .lightred,
  .lightyellow,
  .lightgreen,
  .lightblue,
  .lightpurple,
  .orange,
  .yellow,
  .white a,
  .lightgrey a,
  .lightred a,
  .lightyellow a,
  .lightgreen a,
  .lightblue a,
  .lightpurple a,
  .orange a,
  .yellow a {
    color: #000000;
  }
  .grey,
  .darkgrey,
  .black,
  .red,
  .green,
  .blue,
  .purple,
  .grey a,
  .darkgrey a,
  .black a,
  .red a,
  .green a,
  .blue a,
  .purple a {
    color: #ffffff;
  }

  /* -------------------------------------------------- */
  /* buttons */
  /* -------------------------------------------------- */

  /* class for styling links like buttons */
  .button {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    margin: 5px;
    padding: 10px 20px;
    font-size: 0.75em;
    font-weight: 600;
    text-transform: uppercase;
    text-decoration: none;
    letter-spacing: 1px;
    background: none;
    color: #2196f3;
    border: solid 1px #bdbdbd;
    border-radius: 5px;
  }

  /* buttons when hovered */
  .button:hover:not([disabled]),
  .icon_button:hover:not([disabled]) {
    cursor: pointer;
    background: #f5f5f5;
  }

  /* buttons when disabled */
  .button[disabled],
  .icon_button[disabled] {
    opacity: 0.35;
    pointer-events: none;
  }

  /* class for styling buttons containg only single icon */
  .icon_button {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    text-decoration: none;
    margin: 0;
    padding: 0;
    background: none;
    border-radius: 5px;
    border: none;
    width: 20px;
    height: 20px;
    min-width: 20px;
    min-height: 20px;
  }

  /* icon button inner svg image */
  .icon_button > svg {
    height: 16px;
  }

  /* -------------------------------------------------- */
  /* icons */
  /* -------------------------------------------------- */

  /* class for styling icons inline with text */
  .inline_icon {
    height: 1em;
    position: relative;
    top: 0.125em;
  }

  /* -------------------------------------------------- */
  /* print control */
  /* -------------------------------------------------- */

  @media print {
    @page {
      /* suggested printing margin */
      margin: 0.5in;
    }

    /* document and "page" elements */
    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
    }

    /* "page" element */
    body {
      font-size: 11pt !important;
      line-height: 1.35;
    }

    /* all headings */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      margin: 15px 0;
    }

    /* figures and tables */
    figure,
    table {
      font-size: 0.85em;
    }

    /* table cells */
    th,
    td {
      padding: 5px;
    }

    /* shrink font awesome icons */
    i.fas,
    i.fab,
    i.far,
    i.fal {
      transform: scale(0.85);
    }

    /* decrease banner margins */
    .banner {
      margin-top: 15px;
      margin-bottom: 15px;
      padding: 15px;
    }

    /* class for centering an element vertically on its own page */
    .page_center {
      margin: auto;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      vertical-align: middle;
      break-before: page;
      break-after: page;
    }

    /* always insert a page break before the element */
    .page_break_before {
      break-before: page;
    }

    /* always insert a page break after the element */
    .page_break_after {
      break-after: page;
    }

    /* avoid page break before the element */
    .page_break_before_avoid {
      break-before: avoid;
    }

    /* avoid page break after the element */
    .page_break_after_avoid {
      break-after: avoid;
    }

    /* avoid page break inside the element */
    .page_break_inside_avoid {
      break-inside: avoid;
    }
  }

  /* -------------------------------------------------- */
  /* override pandoc css quirks */
  /* -------------------------------------------------- */

  .sourceCode {
    /* prevent unsightly overflow in wide code blocks */
    overflow: auto !important;
  }

  div.sourceCode {
    /* prevent background fill on top-most code block  container */
    background: none !important;
  }

  .sourceCode * {
    /* force consistent line spacing */
    line-height: 1.5 !important;
  }

  div.sourceCode {
    /* style code block margins same as <pre> element */
    margin-top: 20px;
    margin-bottom: 20px;
  }

  /* -------------------------------------------------- */
  /* tablenos */
  /* -------------------------------------------------- */

  /* tablenos wrapper */
  .tablenos {
    /* show scrollbar on tables if necessary to prevent overflow */
    width: 100%;
    margin: 20px 0;
  }

  .tablenos > table {
    /* move margins from table to table_wrapper to allow margin collapsing */
    margin: 0;
  }

  @media only screen {
    /* tablenos wrapper */
    .tablenos {
      /* show scrollbar on tables if necessary to prevent overflow */
      overflow-x: auto !important;
    }

    .tablenos th,
    .tablenos td {
      overflow-wrap: unset !important;
      word-break: unset !important;
    }

    /* table in wrapper */
    .tablenos table,
    .tablenos table * {
      /* don't break table words */
      overflow-wrap: normal !important;
    }
  }
</style>
<!-- 
    Plugin Core

    Functions needed for and shared across all first-party plugins.
-->

<script>
  // get element that is target of hash (from link element or url)
  function getHashTarget(link) {
    const hash = link ? link.hash : window.location.hash;
    const id = hash.slice(1);
    let target = document.querySelector(`[id="${id}"]`);
    if (!target) return;

    // if figure or table, modify target to get expected element
    if (id.indexOf("fig:") === 0) target = target.querySelector("figure");
    if (id.indexOf("tbl:") === 0) target = target.querySelector("table");

    return target;
  }

  // get position/dimensions of element or viewport
  function getRectInView(element) {
    let rect = {};
    rect.left = 0;
    rect.top = 0;
    rect.right = document.documentElement.clientWidth;
    rect.bottom = document.documentElement.clientHeight;
    let style = {};

    if (element instanceof HTMLElement) {
      rect = element.getBoundingClientRect();
      style = window.getComputedStyle(element);
    }

    const margin = {};
    margin.left = parseFloat(style.marginLeftWidth) || 0;
    margin.top = parseFloat(style.marginTopWidth) || 0;
    margin.right = parseFloat(style.marginRightWidth) || 0;
    margin.bottom = parseFloat(style.marginBottomWidth) || 0;

    const border = {};
    border.left = parseFloat(style.borderLeftWidth) || 0;
    border.top = parseFloat(style.borderTopWidth) || 0;
    border.right = parseFloat(style.borderRightWidth) || 0;
    border.bottom = parseFloat(style.borderBottomWidth) || 0;

    const newRect = {};
    newRect.left = rect.left + margin.left + border.left;
    newRect.top = rect.top + margin.top + border.top;
    newRect.right = rect.right + margin.right + border.right;
    newRect.bottom = rect.bottom + margin.bottom + border.bottom;
    newRect.width = newRect.right - newRect.left;
    newRect.height = newRect.bottom - newRect.top;

    return newRect;
  }

  // get position of element relative to page
  function getRectInPage(element) {
    const rect = getRectInView(element);
    const body = getRectInView(document.body);

    const newRect = {};
    newRect.left = rect.left - body.left;
    newRect.top = rect.top - body.top;
    newRect.right = rect.right - body.left;
    newRect.bottom = rect.bottom - body.top;
    newRect.width = rect.width;
    newRect.height = rect.height;

    return newRect;
  }

  // get closest element before specified element that matches query
  function firstBefore(element, query) {
    while (element && element !== document.body && !element.matches(query))
      element = element.previousElementSibling || element.parentNode;

    return element;
  }

  // check if element is part of collapsed heading
  function isCollapsed(element) {
    while (element && element !== document.body) {
      if (element.dataset.collapsed === "true") return true;
      element = element.parentNode;
    }
    return false;
  }

  // expand any collapsed parent containers of element if necessary
  function expandElement(element) {
    if (isCollapsed(element)) {
      // accordion plugin
      const heading = firstBefore(element, "h2");
      if (heading) heading.click();
      // details/summary HTML element
      const summary = firstBefore(element, "summary");
      if (summary) summary.click();
    }
  }

  // scroll to and focus element
  function goToElement(element, offset) {
    // expand accordion section if collapsed
    expandElement(element);
    const y =
      getRectInView(element).top -
      getRectInView(document.documentElement).top -
      (offset || 0);

    // trigger any function listening for "onscroll" event
    window.dispatchEvent(new Event("scroll"));
    window.scrollTo(0, y);
    document.activeElement.blur();
    element.focus();
  }

  // get list of elements after a start element up to element matching query
  function nextUntil(element, query, exclude) {
    const elements = [];
    while (((element = element.nextElementSibling), element)) {
      if (element.matches(query)) break;
      if (!element.matches(exclude)) elements.push(element);
    }
    return elements;
  }
</script>
<!--
  Accordion Plugin

  Allows sections of content under h2 headings to be collapsible.
-->

<script type="module">
  // whether to always start expanded ('false'), always start collapsed
  // ('true'), or start collapsed when screen small ('auto')
  const startCollapsed = "auto";

  // start script
  function start() {
    // run through each <h2> heading
    const headings = document.querySelectorAll("h2");
    for (const heading of headings) {
      addArrow(heading);

      // start expanded/collapsed based on option
      if (
        startCollapsed === "true" ||
        (startCollapsed === "auto" && isSmallScreen())
      )
        collapseHeading(heading);
      else expandElement(heading);
    }

    // attach hash change listener to window
    window.addEventListener("hashchange", onHashChange);
  }

  // when hash (eg manuscript.html#introduction) changes
  function onHashChange() {
    const target = getHashTarget();
    if (target) goToElement(target);
  }

  // add arrow to heading
  function addArrow(heading) {
    // add arrow button
    const arrow = document.createElement("button");
    arrow.innerHTML = document.querySelector(".icon_angle_down").innerHTML;
    arrow.classList.add("icon_button", "accordion_arrow");
    heading.insertBefore(arrow, heading.firstChild);

    // attach click listener to heading and button
    heading.addEventListener("click", onHeadingClick);
    arrow.addEventListener("click", onArrowClick);
  }

  // determine if on mobile-like device with small screen
  function isSmallScreen() {
    return Math.min(window.innerWidth, window.innerHeight) < 480;
  }

  // when <h2> heading is clicked
  function onHeadingClick(event) {
    // only collapse if <h2> itself is target of click (eg, user did
    // not click on anchor within <h2>)
    if (event.target === this) toggleCollapse(this);
  }

  // when arrow button is clicked
  function onArrowClick() {
    toggleCollapse(this.parentNode);
  }

  // collapse section if expanded, expand if collapsed
  function toggleCollapse(heading) {
    if (heading.dataset.collapsed === "false") collapseHeading(heading);
    else expandElement(heading);
  }

  // elements to exclude from collapse, such as table of contents panel,
  // hypothesis panel, etc
  const exclude = "#toc_panel, div.annotator-frame, #lightbox_overlay";

  // collapse section
  function collapseHeading(heading) {
    heading.setAttribute("data-collapsed", "true");
    const children = getChildren(heading);
    for (const child of children) child.setAttribute("data-collapsed", "true");
  }

  // expand section
  function expandElement(heading) {
    heading.setAttribute("data-collapsed", "false");
    const children = getChildren(heading);
    for (const child of children) child.setAttribute("data-collapsed", "false");
  }

  // get list of elements between this <h2> and next <h2> or <h1>
  // ("children" of the <h2> section)
  function getChildren(heading) {
    return nextUntil(heading, "h2, h1", exclude);
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- angle down icon -->

<template class="icon_angle_down">
  <!-- modified from: https://fontawesome.com/icons/angle-down -->
  <svg width="16" height="16" viewBox="0 0 448 512">
    <path
      fill="currentColor"
      d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* accordion arrow button */
    .accordion_arrow {
      margin-right: 10px;
    }

    /* arrow icon when <h2> data-collapsed attribute true */
    h2[data-collapsed="true"] > .accordion_arrow > svg {
      transform: rotate(-90deg);
    }

    /* all elements (except <h2>'s) when data-collapsed attribute true */
    *:not(h2)[data-collapsed="true"] {
      display: none;
    }

    /* accordion arrow button when hovered and <h2>'s when hovered */
    .accordion_arrow:hover,
    h2[data-collapsed="true"]:hover,
    h2[data-collapsed="false"]:hover {
      cursor: pointer;
    }
  }

  /* always hide accordion arrow button on print */
  @media only print {
    .accordion_arrow {
      display: none;
    }
  }
</style>
<!--
  Anchors Plugin

  Adds an anchor next to each of a certain type of element that provides a
  human-readable url to that specific item/position in the document (e.g.
  "manuscript.html#abstract"). It also makes it such that scrolling out of view
  of a target removes its identifier from the url.
-->

<script type="module">
  // which types of elements to add anchors next to, in "document.querySelector"
  // format
  const typesQuery = 'h1, h2, h3, [id^="fig:"], [id^="tbl:"], [id^="eq:"]';

  // start script
  function start() {
    // add anchor to each element of specified types
    const elements = document.querySelectorAll(typesQuery);
    for (const element of elements) addAnchor(element);

    // attach scroll listener to window
    window.addEventListener("scroll", onScroll);
  }

  // when window is scrolled
  function onScroll() {
    // if url has hash and user has scrolled out of view of hash
    // target, remove hash from url
    const tolerance = 100;
    const target = getHashTarget();
    if (target) {
      if (
        target.getBoundingClientRect().top > window.innerHeight + tolerance ||
        target.getBoundingClientRect().bottom < 0 - tolerance
      )
        history.pushState(null, null, " ");
    }
  }

  // add anchor to element
  function addAnchor(element) {
    let addTo; // element to add anchor button to

    // if figure or table, modify withId and addTo to get expected
    // elements
    if (element.id.indexOf("fig:") === 0) {
      addTo = element.querySelector("figcaption");
    } else if (element.id.indexOf("tbl:") === 0) {
      addTo = element.querySelector("caption");
    } else if (element.id.indexOf("eq:") === 0) {
      addTo = element.querySelector(".eqnos-number");
    }

    addTo = addTo || element;
    const id = element.id || null;

    // do not add anchor if element doesn't have assigned id.
    // id is generated by pandoc and is assumed to be unique and
    // human-readable
    if (!id) return;

    // create anchor button
    const anchor = document.createElement("a");
    anchor.innerHTML = document.querySelector(".icon_link").innerHTML;
    anchor.title = "Link to this part of the document";
    anchor.classList.add("icon_button", "anchor");
    anchor.dataset.ignore = "true";
    anchor.href = "#" + id;
    addTo.appendChild(anchor);
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- link icon -->

<template class="icon_link">
  <!-- modified from: https://fontawesome.com/icons/link -->
  <svg width="16" height="16" viewBox="0 0 512 512">
    <path
      fill="currentColor"
      d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* anchor button */
    .anchor {
      opacity: 0;
      margin-left: 5px;
    }

    /* anchor buttons within <h2>'s */
    h2 .anchor {
      margin-left: 10px;
    }

    /* anchor buttons when hovered/focused and anything containing an anchor button when hovered */
    *:hover > .anchor,
    .anchor:hover,
    .anchor:focus {
      opacity: 1;
    }

    /* anchor button when hovered */
    .anchor:hover {
      cursor: pointer;
    }
  }

  /* always show anchor button on devices with no mouse/hover ability */
  @media (hover: none) {
    .anchor {
      opacity: 1;
    }
  }

  /* always hide anchor button on print */
  @media only print {
    .anchor {
      display: none;
    }
  }
</style>
<!-- 
    Attributes Plugin

    Allows arbitrary HTML attributes to be attached to (almost) any element.
    Place an HTML comment inside or next to the desired element with the content:
    $attribute="value"
-->

<script type="module">
  // start script
  function start() {
    // get list of comments in document
    const comments = findComments();

    for (const comment of comments)
      if (comment.parentElement)
        addAttributes(comment.parentElement, comment.nodeValue.trim());
  }

  // add html attributes to specified element based on string of
  // html attributes and values
  function addAttributes(element, text) {
    // regex's for finding attribute/value pairs in the format of
    // attribute="value" or attribute='value
    const regex2 = /\$([a-zA-Z\-]+)?=\"(.+?)\"/;
    const regex1 = /\$([a-zA-Z\-]+)?=\'(.+?)\'/;

    // loop through attribute/value pairs
    let match;
    while ((match = text.match(regex2) || text.match(regex1))) {
      // get attribute and value from regex capture groups
      let attribute = match[1];
      let value = match[2];

      // remove from string
      text = text.substring(match.index + match[0].length);

      if (!attribute || !value) break;

      // set attribute of parent element
      try {
        element.setAttribute(attribute, value);
      } catch (error) {
        console.log(error);
      }

      // special case for colspan
      if (attribute === "colspan") removeTableCells(element, value);
    }
  }

  // get list of comment elements in document
  function findComments() {
    const comments = [];

    // iterate over comment nodes in document
    function acceptNode(node) {
      return NodeFilter.FILTER_ACCEPT;
    }
    const iterator = document.createNodeIterator(
      document.body,
      NodeFilter.SHOW_COMMENT,
      acceptNode
    );
    let node;
    while ((node = iterator.nextNode())) comments.push(node);

    return comments;
  }

  // remove certain number of cells after specified cell
  function removeTableCells(cell, number) {
    number = parseInt(number);
    if (!number) return;

    // remove elements
    for (; number > 1; number--) {
      if (cell.nextElementSibling) cell.nextElementSibling.remove();
    }
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>
<!--
  Jump to First Plugin

  Adds a button next to each reference entry, figure, and table that jumps the
  page to the first occurrence of a link to that item in the manuscript.
-->

<script type="module">
  // whether to add buttons next to reference entries
  const references = "true";
  // whether to add buttons next to figures
  const figures = "true";
  // whether to add buttons next to tables
  const tables = "true";

  // start script
  function start() {
    if (references !== "false") makeButtons("ref-", "p", "reference");
    if (figures !== "false") makeButtons("fig:", "figcaption", "figure");
    if (tables !== "false") makeButtons("tbl:", "caption", "table");
  }

  // when jump button clicked
  function onButtonClick() {
    const first = getFirstOccurrence(this.dataset.id);
    if (!first) return;

    // update url hash so navigating "back" in history will return user to button
    window.location.hash = this.dataset.id;
    // scroll to link
    const timeout = function () {
      goToElement(first, window.innerHeight * 0.5);
    };
    window.setTimeout(timeout, 0);
  }

  // get first occurrence of link to item in document
  function getFirstOccurrence(id) {
    let query = "a";
    query += '[href="#' + id + '"]';
    // exclude buttons, anchor links, toc links, etc
    query += ":not(.button):not(.icon_button):not(.anchor):not(.toc_link)";
    return document.querySelector(query);
  }

  // add button next to each reference entry, figure, or table
  function makeButtons(query, containerQuery, subject) {
    const elements = document.querySelectorAll(`[id^="${query}"`);
    for (const element of elements) {
      const id = element.id;
      const buttonContainer = element.querySelector(containerQuery);
      const first = getFirstOccurrence(id);

      // if can't find link to reference or place to put button, ignore
      if (!first || !buttonContainer) continue;

      // make jump button
      let button = document.createElement("button");
      button.classList.add("icon_button", "jump_arrow");
      button.title = `Jump to the first occurrence of this ${subject} in the document`;
      const icon = document.querySelector(".icon_angle_double_up");
      button.innerHTML = icon.innerHTML;
      button.dataset.id = id;
      button.dataset.ignore = "true";
      button.addEventListener("click", onButtonClick);
      buttonContainer.prepend(button);
    }
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- angle double up icon -->

<template class="icon_angle_double_up">
  <!-- modified from: https://fontawesome.com/icons/angle-double-up -->
  <svg width="16" height="16" viewBox="0 0 320 512">
    <path
      fill="currentColor"
      d="M177 255.7l136 136c9.4 9.4 9.4 24.6 0 33.9l-22.6 22.6c-9.4 9.4-24.6 9.4-33.9 0L160 351.9l-96.4 96.4c-9.4 9.4-24.6 9.4-33.9 0L7 425.7c-9.4-9.4-9.4-24.6 0-33.9l136-136c9.4-9.5 24.6-9.5 34-.1zm-34-192L7 199.7c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l96.4-96.4 96.4 96.4c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9l-136-136c-9.2-9.4-24.4-9.4-33.8 0z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* jump button */
    .jump_arrow {
      position: relative;
      top: 0.125em;
      margin-right: 5px;
    }
  }

  /* always hide jump button on print */
  @media only print {
    .jump_arrow {
      display: none;
    }
  }
</style>
<!-- 
    Lightbox Plugin

    Makes it such that when a user clicks on an image, the image fills the
    screen and the user can pan/drag/zoom the image and navigate between other
    images in the document.
-->

<script type="module">
  // list of possible zoom/scale factors
  const zooms =
    "0.1, 0.25, 0.333333, 0.5, 0.666666, 0.75, 1, 1.25, 1.5, 1.75, 2, 2.5, 3, 3.5, 4, 5, 6, 7, 8";
  // whether to fit image to view ('fit'), display at 100% and shrink if
  // necessary ('shrink'), or always display at 100% ('100')
  const defaultZoom = "fit";
  // whether to zoom in/out toward center of view ('true') or mouse ('false')
  const centerZoom = "false";

  // start script
  function start() {
    // run through each <img> element
    const imgs = document.querySelectorAll("figure > img");
    let count = 1;
    for (const img of imgs) {
      img.classList.add("lightbox_document_img");
      img.dataset.number = count;
      img.dataset.total = imgs.length;
      img.addEventListener("click", openLightbox);
      count++;
    }

    // attach mouse and key listeners to window
    window.addEventListener("mousemove", onWindowMouseMove);
    window.addEventListener("keyup", onKeyUp);
  }

  // when mouse is moved anywhere in window
  function onWindowMouseMove(event) {
    window.mouseX = event.clientX;
    window.mouseY = event.clientY;
  }

  // when key pressed
  function onKeyUp(event) {
    if (!event || !event.key) return;

    switch (event.key) {
      // trigger click of prev button
      case "ArrowLeft":
        const prevButton = document.getElementById("lightbox_prev_button");
        if (prevButton) prevButton.click();
        break;
      // trigger click of next button
      case "ArrowRight":
        const nextButton = document.getElementById("lightbox_next_button");
        if (nextButton) nextButton.click();
        break;
      // close on esc
      case "Escape":
        closeLightbox();
        break;
    }
  }

  // open lightbox
  function openLightbox() {
    const lightbox = makeLightbox(this);
    if (!lightbox) return;

    blurBody(lightbox);
    document.body.appendChild(lightbox);
  }

  // make lightbox
  function makeLightbox(img) {
    // delete lightbox if it exists, start fresh
    closeLightbox();

    // create screen overlay containing lightbox
    const overlay = document.createElement("div");
    overlay.id = "lightbox_overlay";

    // create image info boxes
    const numberInfo = document.createElement("div");
    const zoomInfo = document.createElement("div");
    numberInfo.id = "lightbox_number_info";
    zoomInfo.id = "lightbox_zoom_info";

    // create container for image
    const imageContainer = document.createElement("div");
    imageContainer.id = "lightbox_image_container";
    const lightboxImg = makeLightboxImg(
      img,
      imageContainer,
      numberInfo,
      zoomInfo
    );
    imageContainer.appendChild(lightboxImg);

    // create bottom container for caption and navigation buttons
    const bottomContainer = document.createElement("div");
    bottomContainer.id = "lightbox_bottom_container";
    const caption = makeCaption(img);
    const prevButton = makePrevButton(img);
    const nextButton = makeNextButton(img);
    bottomContainer.appendChild(prevButton);
    bottomContainer.appendChild(caption);
    bottomContainer.appendChild(nextButton);

    // attach top middle and bottom to overlay
    overlay.appendChild(numberInfo);
    overlay.appendChild(zoomInfo);
    overlay.appendChild(imageContainer);
    overlay.appendChild(bottomContainer);

    return overlay;
  }

  // make <img> object that is intuitively draggable and zoomable
  function makeLightboxImg(sourceImg, container, numberInfoBox, zoomInfoBox) {
    // create copy of source <img>
    const img = sourceImg.cloneNode(true);
    img.classList.remove("lightbox_document_img");
    img.removeAttribute("id");
    img.removeAttribute("width");
    img.removeAttribute("height");
    img.style.position = "unset";
    img.style.margin = "0";
    img.style.padding = "0";
    img.style.width = "";
    img.style.height = "";
    img.style.minWidth = "";
    img.style.minHeight = "";
    img.style.maxWidth = "";
    img.style.maxHeight = "";
    img.id = "lightbox_img";

    // build sorted list of zoomSteps
    const zoomSteps = zooms.split(/[^0-9.]/).map((step) => parseFloat(step));
    zoomSteps.sort((a, b) => a - b);

    // <img> object property variables
    let zoom = 1;
    let translateX = 0;
    let translateY = 0;
    let clickMouseX = undefined;
    let clickMouseY = undefined;
    let clickTranslateX = undefined;
    let clickTranslateY = undefined;

    updateNumberInfo();

    // update image numbers displayed in info box
    function updateNumberInfo() {
      numberInfoBox.innerHTML =
        sourceImg.dataset.number + " of " + sourceImg.dataset.total;
    }

    // update zoom displayed in info box
    function updateZoomInfo() {
      let zoomInfo = zoom * 100;
      if (!Number.isInteger(zoomInfo)) zoomInfo = zoomInfo.toFixed(2);
      zoomInfoBox.innerHTML = zoomInfo + "%";
    }

    // move to closest zoom step above current zoom
    const zoomIn = function () {
      for (const zoomStep of zoomSteps) {
        if (zoomStep > zoom) {
          zoom = zoomStep;
          break;
        }
      }
      updateTransform();
    };

    // move to closest zoom step above current zoom
    const zoomOut = function () {
      zoomSteps.reverse();
      for (const zoomStep of zoomSteps) {
        if (zoomStep < zoom) {
          zoom = zoomStep;
          break;
        }
      }
      zoomSteps.reverse();

      updateTransform();
    };

    // update display of <img> based on scale/translate properties
    const updateTransform = function () {
      // set transform
      img.style.transform =
        "translate(" +
        (translateX || 0) +
        "px," +
        (translateY || 0) +
        "px) scale(" +
        (zoom || 1) +
        ")";

      // get new width/height after scale
      const rect = img.getBoundingClientRect();
      // limit translate
      translateX = Math.max(translateX, -rect.width / 2);
      translateX = Math.min(translateX, rect.width / 2);
      translateY = Math.max(translateY, -rect.height / 2);
      translateY = Math.min(translateY, rect.height / 2);

      // set transform
      img.style.transform =
        "translate(" +
        (translateX || 0) +
        "px," +
        (translateY || 0) +
        "px) scale(" +
        (zoom || 1) +
        ")";

      updateZoomInfo();
    };

    // fit <img> to container
    const fit = function () {
      // no x/y offset, 100% zoom by default
      translateX = 0;
      translateY = 0;
      zoom = 1;

      // widths of <img> and container
      const imgWidth = img.naturalWidth;
      const imgHeight = img.naturalHeight;
      const containerWidth = parseFloat(
        window.getComputedStyle(container).width
      );
      const containerHeight = parseFloat(
        window.getComputedStyle(container).height
      );

      // how much zooming is needed to fit <img> to container
      const xRatio = imgWidth / containerWidth;
      const yRatio = imgHeight / containerHeight;
      const maxRatio = Math.max(xRatio, yRatio);
      const newZoom = 1 / maxRatio;

      // fit <img> to container according to option
      if (defaultZoom === "shrink") {
        if (maxRatio > 1) zoom = newZoom;
      } else if (defaultZoom === "fit") zoom = newZoom;

      updateTransform();
    };

    // when mouse wheel is rolled anywhere in container
    const onContainerWheel = function (event) {
      if (!event) return;

      // let ctrl + mouse wheel to zoom behave as normal
      if (event.ctrlKey) return;

      // prevent normal scroll behavior
      event.preventDefault();
      event.stopPropagation();

      // point around which to scale img
      const viewRect = container.getBoundingClientRect();
      const viewX = (viewRect.left + viewRect.right) / 2;
      const viewY = (viewRect.top + viewRect.bottom) / 2;
      const originX = centerZoom === "true" ? viewX : mouseX;
      const originY = centerZoom === "true" ? viewY : mouseY;

      // get point on image under origin
      const oldRect = img.getBoundingClientRect();
      const oldPercentX = (originX - oldRect.left) / oldRect.width;
      const oldPercentY = (originY - oldRect.top) / oldRect.height;

      // increment/decrement zoom
      if (event.deltaY < 0) zoomIn();
      if (event.deltaY > 0) zoomOut();

      // get offset between previous image point and origin
      const newRect = img.getBoundingClientRect();
      const offsetX = originX - (newRect.left + newRect.width * oldPercentX);
      const offsetY = originY - (newRect.top + newRect.height * oldPercentY);

      // translate image to keep image point under origin
      translateX += offsetX;
      translateY += offsetY;

      // perform translate
      updateTransform();
    };

    // when container is clicked
    function onContainerClick(event) {
      // if container itself is target of click, and not other
      // element above it
      if (event.target === this) closeLightbox();
    }

    // when mouse button is pressed on image
    const onImageMouseDown = function (event) {
      // store original mouse position relative to image
      clickMouseX = window.mouseX;
      clickMouseY = window.mouseY;
      clickTranslateX = translateX;
      clickTranslateY = translateY;
      event.stopPropagation();
      event.preventDefault();
    };

    // when mouse button is released anywhere in window
    const onWindowMouseUp = function (event) {
      // reset original mouse position
      clickMouseX = undefined;
      clickMouseY = undefined;
      clickTranslateX = undefined;
      clickTranslateY = undefined;

      // remove global listener if lightbox removed from document
      if (!document.body.contains(container))
        window.removeEventListener("mouseup", onWindowMouseUp);
    };

    // when mouse is moved anywhere in window
    const onWindowMouseMove = function (event) {
      if (
        clickMouseX === undefined ||
        clickMouseY === undefined ||
        clickTranslateX === undefined ||
        clickTranslateY === undefined
      )
        return;

      // offset image based on original and current mouse position
      translateX = clickTranslateX + window.mouseX - clickMouseX;
      translateY = clickTranslateY + window.mouseY - clickMouseY;
      updateTransform();
      event.preventDefault();

      // remove global listener if lightbox removed from document
      if (!document.body.contains(container))
        window.removeEventListener("mousemove", onWindowMouseMove);
    };

    // when window is resized
    const onWindowResize = function (event) {
      fit();

      // remove global listener if lightbox removed from document
      if (!document.body.contains(container))
        window.removeEventListener("resize", onWindowResize);
    };

    // attach the necessary event listeners
    img.addEventListener("dblclick", fit);
    img.addEventListener("mousedown", onImageMouseDown);
    container.addEventListener("wheel", onContainerWheel);
    container.addEventListener("mousedown", onContainerClick);
    container.addEventListener("touchstart", onContainerClick);
    window.addEventListener("mouseup", onWindowMouseUp);
    window.addEventListener("mousemove", onWindowMouseMove);
    window.addEventListener("resize", onWindowResize);

    // run fit() after lightbox atttached to document and <img> Loaded
    // so needed container and img dimensions available
    img.addEventListener("load", fit);

    return img;
  }

  // make caption
  function makeCaption(img) {
    const caption = document.createElement("div");
    caption.id = "lightbox_caption";
    const captionSource = img.nextElementSibling;
    if (captionSource.tagName.toLowerCase() === "figcaption") {
      const captionCopy = makeCopy(captionSource);
      caption.innerHTML = captionCopy.innerHTML;
    }

    caption.addEventListener("touchstart", function (event) {
      event.stopPropagation();
    });

    return caption;
  }

  // make carbon copy of html dom element
  function makeCopy(source) {
    const sourceCopy = source.cloneNode(true);

    // delete elements marked with ignore (eg anchor and jump buttons)
    const deleteFromCopy = sourceCopy.querySelectorAll('[data-ignore="true"]');
    for (const element of deleteFromCopy) element.remove();

    // delete certain element attributes
    const attributes = [
      "id",
      "data-collapsed",
      "data-selected",
      "data-highlighted",
      "data-glow",
    ];
    for (const attribute of attributes) {
      sourceCopy.removeAttribute(attribute);
      const elements = sourceCopy.querySelectorAll("[" + attribute + "]");
      for (const element of elements) element.removeAttribute(attribute);
    }

    return sourceCopy;
  }

  // make button to jump to previous image in document
  function makePrevButton(img) {
    const prevButton = document.createElement("button");
    prevButton.id = "lightbox_prev_button";
    prevButton.title = "Jump to the previous image in the document [←]";
    prevButton.classList.add("icon_button", "lightbox_button");
    prevButton.innerHTML = document.querySelector(".icon_caret_left").innerHTML;

    // attach click listeners to button
    prevButton.addEventListener("click", function () {
      getPrevImg(img).click();
    });

    return prevButton;
  }

  // make button to jump to next image in document
  function makeNextButton(img) {
    const nextButton = document.createElement("button");
    nextButton.id = "lightbox_next_button";
    nextButton.title = "Jump to the next image in the document [→]";
    nextButton.classList.add("icon_button", "lightbox_button");
    nextButton.innerHTML = document.querySelector(
      ".icon_caret_right"
    ).innerHTML;

    // attach click listeners to button
    nextButton.addEventListener("click", function () {
      getNextImg(img).click();
    });

    return nextButton;
  }

  // get previous image in document
  function getPrevImg(img) {
    const imgs = document.querySelectorAll(".lightbox_document_img");

    // find index of provided img
    let index;
    for (index = 0; index < imgs.length; index++) {
      if (imgs[index] === img) break;
    }

    // wrap index to other side if < 1
    if (index - 1 >= 0) index--;
    else index = imgs.length - 1;
    return imgs[index];
  }

  // get next image in document
  function getNextImg(img) {
    const imgs = document.querySelectorAll(".lightbox_document_img");

    // find index of provided img
    let index;
    for (index = 0; index < imgs.length; index++) {
      if (imgs[index] === img) break;
    }

    // wrap index to other side if > total
    if (index + 1 <= imgs.length - 1) index++;
    else index = 0;
    return imgs[index];
  }

  // close lightbox
  function closeLightbox() {
    focusBody();

    const lightbox = document.getElementById("lightbox_overlay");
    if (lightbox) lightbox.remove();
  }

  // make all elements behind lightbox non-focusable
  function blurBody(overlay) {
    const all = document.querySelectorAll("*");
    for (const element of all) element.tabIndex = -1;
    document.body.classList.add("body_no_scroll");
  }

  // make all elements focusable again
  function focusBody() {
    const all = document.querySelectorAll("*");
    for (const element of all) element.removeAttribute("tabIndex");
    document.body.classList.remove("body_no_scroll");
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
  <!-- modified from: https://fontawesome.com/icons/caret-left -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
    ></path>
  </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
  <!-- modified from: https://fontawesome.com/icons/caret-right -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* regular <img> in document when hovered */
    img.lightbox_document_img:hover {
      cursor: pointer;
    }

    .body_no_scroll {
      overflow: hidden !important;
    }

    /* screen overlay */
    #lightbox_overlay {
      display: flex;
      flex-direction: column;
      position: fixed;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.75);
      z-index: 3;
    }

    /* middle area containing lightbox image */
    #lightbox_image_container {
      flex-grow: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
      position: relative;
      padding: 20px;
    }

    /* bottom area containing caption */
    #lightbox_bottom_container {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100px;
      min-height: 100px;
      max-height: 100px;
      background: rgba(0, 0, 0, 0.5);
    }

    /* image number info text box */
    #lightbox_number_info {
      position: absolute;
      color: #ffffff;
      font-weight: 600;
      left: 2px;
      top: 0;
      z-index: 4;
    }

    /* zoom info text box */
    #lightbox_zoom_info {
      position: absolute;
      color: #ffffff;
      font-weight: 600;
      right: 2px;
      top: 0;
      z-index: 4;
    }

    /* copy of image caption */
    #lightbox_caption {
      box-sizing: border-box;
      display: inline-block;
      width: 100%;
      max-height: 100%;
      padding: 10px 0;
      text-align: center;
      overflow-y: auto;
      color: #ffffff;
    }

    /* navigation previous/next button */
    .lightbox_button {
      width: 100px;
      height: 100%;
      min-width: 100px;
      min-height: 100%;
      color: #ffffff;
    }

    /* navigation previous/next button when hovered */
    .lightbox_button:hover {
      background: none !important;
    }

    /* navigation button icon */
    .lightbox_button > svg {
      height: 25px;
    }

    /* figure auto-number */
    #lightbox_caption > span:first-of-type {
      font-weight: bold;
      margin-right: 5px;
    }

    /* lightbox image when hovered */
    #lightbox_img:hover {
      cursor: grab;
    }

    /* lightbox image when grabbed */
    #lightbox_img:active {
      cursor: grabbing;
    }
  }

  /* when on screen < 480px wide */
  @media only screen and (max-width: 480px) {
    /* make navigation buttons skinnier on small screens to make more room for caption text */
    .lightbox_button {
      width: 50px;
      min-width: 50px;
    }
  }

  /* always hide lightbox on print */
  @media only print {
    #lightbox_overlay {
      display: none;
    }
  }
</style>
<!-- 
  Link Highlight Plugin

  Makes it such that when a user hovers or focuses a link, other links that have
  the same target will be highlighted. It also makes it such that when clicking
  a link, the target of the link (eg reference, figure, table) is briefly
  highlighted.
-->

<script type="module">
  // whether to also highlight links that go to external urls
  const externalLinks = "false";
  // whether user must click off to unhighlight instead of just
  // un-hovering
  const clickUnhighlight = "false";
  // whether to also highlight links that are unique
  const highlightUnique = "true";

  // start script
  function start() {
    const links = getLinks();
    for (const link of links) {
      // attach mouse and focus listeners to link
      link.addEventListener("mouseenter", onLinkFocus);
      link.addEventListener("focus", onLinkFocus);
      link.addEventListener("mouseleave", onLinkUnhover);
    }

    // attach click and hash change listeners to window
    window.addEventListener("click", onClick);
    window.addEventListener("touchstart", onClick);
    window.addEventListener("hashchange", onHashChange);

    // run hash change on window load in case user has navigated
    // directly to hash
    onHashChange();
  }

  // when link is focused (tabbed to) or hovered
  function onLinkFocus() {
    highlight(this);
  }

  // when link is unhovered
  function onLinkUnhover() {
    if (clickUnhighlight !== "true") unhighlightAll();
  }

  // when the mouse is clicked anywhere in window
  function onClick(event) {
    unhighlightAll();
  }

  // when hash (eg manuscript.html#introduction) changes
  function onHashChange() {
    const target = getHashTarget();
    if (target) glowElement(target);
  }

  // start glow sequence on an element
  function glowElement(element) {
    const startGlow = function () {
      onGlowEnd();
      element.dataset.glow = "true";
      element.addEventListener("animationend", onGlowEnd);
    };
    const onGlowEnd = function () {
      element.removeAttribute("data-glow");
      element.removeEventListener("animationend", onGlowEnd);
    };
    startGlow();
  }

  // highlight link and all others with same target
  function highlight(link) {
    // force unhighlight all to start fresh
    unhighlightAll();

    // get links with same target
    if (!link) return;
    const sameLinks = getSameLinks(link);

    // if link unique and option is off, exit and don't highlight
    if (sameLinks.length <= 1 && highlightUnique !== "true") return;

    // highlight all same links, and "select" (special highlight) this
    // one
    for (const sameLink of sameLinks) {
      if (sameLink === link) sameLink.setAttribute("data-selected", "true");
      else sameLink.setAttribute("data-highlighted", "true");
    }
  }

  // unhighlight all links
  function unhighlightAll() {
    const links = getLinks();
    for (const link of links) {
      link.setAttribute("data-selected", "false");
      link.setAttribute("data-highlighted", "false");
    }
  }

  // get links with same target
  function getSameLinks(link) {
    const results = [];
    const links = getLinks();
    for (const otherLink of links) {
      if (otherLink.getAttribute("href") === link.getAttribute("href"))
        results.push(otherLink);
    }
    return results;
  }

  // get all links of types we wish to handle
  function getLinks() {
    let query = "a";
    if (externalLinks !== "true") query += '[href^="#"]';
    // exclude buttons, anchor links, toc links, etc
    query += ":not(.button):not(.icon_button):not(.anchor):not(.toc_link)";
    return document.querySelectorAll(query);
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<style>
  @media only screen {
    /* anything with data-highlighted attribute true */
    [data-highlighted="true"] {
      background: #ffeb3b;
    }

    /* anything with data-selected attribute true */
    [data-selected="true"] {
      background: #ff8a65 !important;
    }

    /* animation definition for glow */
    @keyframes highlight_glow {
      0% {
        background: none;
      }
      10% {
        background: #bbdefb;
      }
      100% {
        background: none;
      }
    }

    /* anything with data-glow attribute true */
    [data-glow="true"] {
      animation: highlight_glow 2s;
    }
  }
</style>
<!--
  Table of Contents Plugin

  Provides a "table of contents" (toc) panel on the side of the document that
  allows the user to conveniently navigate between sections of the document.
-->

<script type="module">
  // which types of elements to add links for, in "document.querySelector" format
  const typesQuery = "h1, h2, h3";
  // whether toc starts open. use 'true' or 'false', or 'auto' to
  // use 'true' behavior when screen wide enough and 'false' when not
  const startOpen = "false";
  // whether toc closes when clicking on toc link. use 'true' or
  // 'false', or 'auto' to use 'false' behavior when screen wide
  // enough and 'true' when not
  const clickClose = "auto";
  // if list item is more than this many characters, text will be
  // truncated
  const charLimit = "50";
  // whether or not to show bullets next to each toc item
  const bullets = "false";

  // start script
  function start() {
    // make toc panel and populate with entries (links to document
    // sections)
    const panel = makePanel();
    if (!panel) return;
    makeEntries(panel);
    // attach panel to document after making entries, so 'toc' heading
    // in panel isn't included in toc
    document.body.insertBefore(panel, document.body.firstChild);

    // initial panel state
    if (startOpen === "true" || (startOpen === "auto" && !isSmallScreen()))
      openPanel();
    else closePanel();

    // attach click, scroll, and hash change listeners to window
    window.addEventListener("click", onClick);
    window.addEventListener("scroll", onScroll);
    window.addEventListener("hashchange", onScroll);
    window.addEventListener("keyup", onKeyUp);
    onScroll();

    // add class to push document body down out of way of toc button
    document.body.classList.add("toc_body_nudge");
  }

  // determine if screen wide enough to fit toc panel
  function isSmallScreen() {
    // in default theme:
    // 816px = 8.5in = width of "page" (<body>) element
    // 260px = min width of toc panel (*2 for both sides of <body>)
    return window.innerWidth < 816 + 260 * 2;
  }

  // when mouse is clicked anywhere in window
  function onClick() {
    if (isSmallScreen()) closePanel();
  }

  // when window is scrolled or hash changed
  function onScroll() {
    highlightViewed();
  }

  // when key pressed
  function onKeyUp(event) {
    if (!event || !event.key) return;

    // close on esc
    if (event.key === "Escape") closePanel();
  }

  // find entry of currently viewed document section in toc and highlight
  function highlightViewed() {
    const firstId = getFirstInView(typesQuery);

    // get toc entries (links), unhighlight all, then highlight viewed
    const list = document.getElementById("toc_list");
    if (!firstId || !list) return;
    const links = list.querySelectorAll("a");
    for (const link of links) link.dataset.viewing = "false";
    const link = list.querySelector('a[href="#' + firstId + '"]');
    if (!link) return;
    link.dataset.viewing = "true";
  }

  // get first or previous toc listed element in top half of view
  function getFirstInView(query) {
    // get all elements matching query and with id
    const elements = document.querySelectorAll(query);
    const elementsWithIds = [];
    for (const element of elements) {
      if (element.id) elementsWithIds.push(element);
    }

    // get first or previous element in top half of view
    for (let i = 0; i < elementsWithIds.length; i++) {
      const element = elementsWithIds[i];
      const prevElement = elementsWithIds[Math.max(0, i - 1)];
      if (element.getBoundingClientRect().top >= 0) {
        if (element.getBoundingClientRect().top < window.innerHeight / 2)
          return element.id;
        else return prevElement.id;
      }
    }
  }

  // make panel
  function makePanel() {
    // create panel
    const panel = document.createElement("div");
    panel.id = "toc_panel";
    if (bullets === "true") panel.dataset.bullets = "true";

    // create header
    const header = document.createElement("div");
    header.id = "toc_header";

    // create toc button
    const button = document.createElement("button");
    button.id = "toc_button";
    button.innerHTML = document.querySelector(".icon_th_list").innerHTML;
    button.title = "Table of Contents";
    button.classList.add("icon_button");

    // create header text
    const text = document.createElement("h4");
    text.innerHTML = "Table of Contents";

    // create container for toc list
    const list = document.createElement("div");
    list.id = "toc_list";

    // attach click listeners
    panel.addEventListener("click", onPanelClick);
    header.addEventListener("click", onHeaderClick);
    button.addEventListener("click", onButtonClick);

    // attach elements
    header.appendChild(button);
    header.appendChild(text);
    panel.appendChild(header);
    panel.appendChild(list);

    return panel;
  }

  // create toc entries (links) to each element of the specified types
  function makeEntries(panel) {
    const elements = document.querySelectorAll(typesQuery);
    for (const element of elements) {
      // do not add link if element doesn't have assigned id
      if (!element.id) continue;

      // create link/list item
      const link = document.createElement("a");
      link.classList.add("toc_link");
      switch (element.tagName.toLowerCase()) {
        case "h1":
          link.dataset.level = "1";
          break;
        case "h2":
          link.dataset.level = "2";
          break;
        case "h3":
          link.dataset.level = "3";
          break;
        case "h4":
          link.dataset.level = "4";
          break;
      }
      link.title = element.innerText;
      let text = element.innerText;
      if (text.length > charLimit) text = text.slice(0, charLimit) + "...";
      link.innerHTML = text;
      link.href = "#" + element.id;
      link.addEventListener("click", onLinkClick);

      // attach link
      panel.querySelector("#toc_list").appendChild(link);
    }
  }

  // when panel is clicked
  function onPanelClick(event) {
    // stop click from propagating to window/document and closing panel
    event.stopPropagation();
  }

  // when header itself is clicked
  function onHeaderClick(event) {
    togglePanel();
  }

  // when button is clicked
  function onButtonClick(event) {
    togglePanel();
    // stop header underneath button from also being clicked
    event.stopPropagation();
  }

  // when link is clicked
  function onLinkClick(event) {
    if (clickClose === "true" || (clickClose === "auto" && isSmallScreen()))
      closePanel();
    else openPanel();
  }

  // open panel if closed, close if opened
  function togglePanel() {
    const panel = document.getElementById("toc_panel");
    if (!panel) return;

    if (panel.dataset.open === "true") closePanel();
    else openPanel();
  }

  // open panel
  function openPanel() {
    const panel = document.getElementById("toc_panel");
    if (panel) panel.dataset.open = "true";
  }

  // close panel
  function closePanel() {
    const panel = document.getElementById("toc_panel");
    if (panel) panel.dataset.open = "false";
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- th list icon -->

<template class="icon_th_list">
  <!-- modified from: https://fontawesome.com/icons/th-list -->
  <svg width="16" height="16" viewBox="0 0 512 512" tabindex="-1">
    <path
      fill="currentColor"
      d="M96 96c0 26.51-21.49 48-48 48S0 122.51 0 96s21.49-48 48-48 48 21.49 48 48zM48 208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm0 160c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm96-236h352c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h352c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H144c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"
      tabindex="-1"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* toc panel */
    #toc_panel {
      box-sizing: border-box;
      position: fixed;
      top: 0;
      left: 0;
      background: #ffffff;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
      z-index: 2;
    }

    /* toc panel when closed */
    #toc_panel[data-open="false"] {
      min-width: 60px;
      width: 60px;
      height: 60px;
      border-right: solid 1px #bdbdbd;
      border-bottom: solid 1px #bdbdbd;
    }

    /* toc panel when open */
    #toc_panel[data-open="true"] {
      min-width: 260px;
      max-width: 480px;
      /* keep panel edge consistent distance away from "page" edge */
      width: calc(((100vw - 8.5in) / 2) - 30px - 40px);
      bottom: 0;
      border-right: solid 1px #bdbdbd;
    }

    /* toc panel header */
    #toc_header {
      box-sizing: border-box;
      display: flex;
      flex-direction: row;
      align-items: center;
      height: 60px;
      margin: 0;
      padding: 20px;
    }

    /* toc panel header when hovered */
    #toc_header:hover {
      cursor: pointer;
    }

    /* toc panel header when panel open */
    #toc_panel[data-open="true"] > #toc_header {
      border-bottom: solid 1px #bdbdbd;
    }

    /* toc open/close header button */
    #toc_button {
      margin-right: 20px;
    }

    /* hide toc list and header text when closed */
    #toc_panel[data-open="false"] > #toc_header > *:not(#toc_button),
    #toc_panel[data-open="false"] > #toc_list {
      display: none;
    }

    /* toc list of entries */
    #toc_list {
      box-sizing: border-box;
      width: 100%;
      padding: 20px;
      position: absolute;
      top: calc(60px + 1px);
      bottom: 0;
      overflow: auto;
    }

    /* toc entry, link to section in document */
    .toc_link {
      display: block;
      padding: 5px;
      position: relative;
      font-weight: 600;
      text-decoration: none;
    }

    /* toc entry when hovered or when "viewed" */
    .toc_link:hover,
    .toc_link[data-viewing="true"] {
      background: #f5f5f5;
    }

    /* toc entry, level 1 indentation */
    .toc_link[data-level="1"] {
      margin-left: 0;
    }

    /* toc entry, level 2 indentation */
    .toc_link[data-level="2"] {
      margin-left: 20px;
    }

    /* toc entry, level 3 indentation */
    .toc_link[data-level="3"] {
      margin-left: 40px;
    }

    /* toc entry, level 4 indentation */
    .toc_link[data-level="4"] {
      margin-left: 60px;
    }

    /* toc entry bullets */
    #toc_panel[data-bullets="true"] .toc_link[data-level]:before {
      position: absolute;
      left: -15px;
      top: -1px;
      font-size: 1.5em;
    }

    /* toc entry, level 2 bullet */
    #toc_panel[data-bullets="true"] .toc_link[data-level="2"]:before {
      content: "\2022";
    }

    /* toc entry, level 3 bullet */
    #toc_panel[data-bullets="true"] .toc_link[data-level="3"]:before {
      content: "\25AB";
    }

    /* toc entry, level 4 bullet */
    #toc_panel[data-bullets="true"] .toc_link[data-level="4"]:before {
      content: "-";
    }
  }

  /* when on screen < 8.5in wide */
  @media only screen and (max-width: 8.5in) {
    /* push <body> ("page") element down to make room for toc icon */
    .toc_body_nudge {
      padding-top: 60px;
    }

    /* toc icon when panel closed and not hovered */
    #toc_panel[data-open="false"]:not(:hover) {
      background: rgba(255, 255, 255, 0.75);
    }
  }

  /* always hide toc panel on print */
  @media only print {
    #toc_panel {
      display: none;
    }
  }
</style>
<!-- 
  Tooltips Plugin

  Makes it such that when the user hovers or focuses a link to a citation or
  figure, a tooltip appears with a preview of the reference content, along with
  arrows to navigate between instances of the same reference in the document.
-->

<script type="module">
  // whether user must click off to close tooltip instead of just un-hovering
  const clickClose = "false";
  // delay (in ms) between opening and closing tooltip
  const delay = "100";

  // start script
  function start() {
    const links = getLinks();
    for (const link of links) {
      // attach hover and focus listeners to link
      link.addEventListener("mouseover", onLinkHover);
      link.addEventListener("mouseleave", onLinkUnhover);
      link.addEventListener("focus", onLinkFocus);
      link.addEventListener("touchend", onLinkTouch);
    }

    // attach mouse, key, and resize listeners to window
    window.addEventListener("mousedown", onClick);
    window.addEventListener("touchstart", onClick);
    window.addEventListener("keyup", onKeyUp);
    window.addEventListener("resize", onResize);
  }

  // when link is hovered
  function onLinkHover() {
    // function to open tooltip
    const delayOpenTooltip = function () {
      openTooltip(this);
    }.bind(this);

    // run open function after delay
    this.openTooltipTimer = window.setTimeout(delayOpenTooltip, delay);
  }

  // when mouse leaves link
  function onLinkUnhover() {
    // cancel opening tooltip
    window.clearTimeout(this.openTooltipTimer);

    // don't close on unhover if option specifies
    if (clickClose === "true") return;

    // function to close tooltip
    const delayCloseTooltip = function () {
      // if tooltip open and if mouse isn't over tooltip, close
      const tooltip = document.getElementById("tooltip");
      if (tooltip && !tooltip.matches(":hover")) closeTooltip();
    };

    // run close function after delay
    this.closeTooltipTimer = window.setTimeout(delayCloseTooltip, delay);
  }

  // when link is focused (tabbed to)
  function onLinkFocus(event) {
    openTooltip(this);
  }

  // when link is touched on touch screen
  function onLinkTouch(event) {
    // attempt to force hover state on first tap always, and trigger
    // regular link click (and navigation) on second tap
    if (event.target === document.activeElement) event.target.click();
    else {
      document.activeElement.blur();
      event.target.focus();
    }
    if (event.cancelable) event.preventDefault();
    event.stopPropagation();
    return false;
  }

  // when mouse is clicked anywhere in window
  function onClick(event) {
    closeTooltip();
  }

  // when key pressed
  function onKeyUp(event) {
    if (!event || !event.key) return;

    switch (event.key) {
      // trigger click of prev button
      case "ArrowLeft":
        const prevButton = document.getElementById("tooltip_prev_button");
        if (prevButton) prevButton.click();
        break;
      // trigger click of next button
      case "ArrowRight":
        const nextButton = document.getElementById("tooltip_next_button");
        if (nextButton) nextButton.click();
        break;
      // close on esc
      case "Escape":
        closeTooltip();
        break;
    }
  }

  // when window is resized or zoomed
  function onResize() {
    closeTooltip();
  }

  // get all links of types we wish to handle
  function getLinks() {
    const queries = [];
    // exclude buttons, anchor links, toc links, etc
    const exclude =
      ":not(.button):not(.icon_button):not(.anchor):not(.toc_link)";
    queries.push('a[href^="#ref-"]' + exclude); // citation links
    queries.push('a[href^="#fig:"]' + exclude); // figure links
    const query = queries.join(", ");
    return document.querySelectorAll(query);
  }

  // get links with same target, get index of link in set, get total
  // same links
  function getSameLinks(link) {
    const sameLinks = [];
    const links = getLinks();
    for (const otherLink of links) {
      if (otherLink.getAttribute("href") === link.getAttribute("href"))
        sameLinks.push(otherLink);
    }

    return {
      elements: sameLinks,
      index: sameLinks.indexOf(link),
      total: sameLinks.length,
    };
  }

  // open tooltip
  function openTooltip(link) {
    // delete tooltip if it exists, start fresh
    closeTooltip();

    // make tooltip element
    const tooltip = makeTooltip(link);

    // if source couldn't be found and tooltip not made, exit
    if (!tooltip) return;

    // make navbar elements
    const navBar = makeNavBar(link);
    if (navBar) tooltip.firstElementChild.appendChild(navBar);

    // attach tooltip to page
    document.body.appendChild(tooltip);

    // position tooltip
    const position = function () {
      positionTooltip(link);
    };
    position();

    // if tooltip contains images, position again after they've loaded
    const imgs = tooltip.querySelectorAll("img");
    for (const img of imgs) img.addEventListener("load", position);
  }

  // close (delete) tooltip
  function closeTooltip() {
    const tooltip = document.getElementById("tooltip");
    if (tooltip) tooltip.remove();
  }

  // make tooltip
  function makeTooltip(link) {
    // get target element that link points to
    const source = getSource(link);

    // if source can't be found, exit
    if (!source) return;

    // create new tooltip
    const tooltip = document.createElement("div");
    tooltip.id = "tooltip";
    const tooltipContent = document.createElement("div");
    tooltipContent.id = "tooltip_content";
    tooltip.appendChild(tooltipContent);

    // make copy of source node and put in tooltip
    const sourceCopy = makeCopy(source);
    tooltipContent.appendChild(sourceCopy);

    // attach mouse event listeners
    tooltip.addEventListener("click", onTooltipClick);
    tooltip.addEventListener("mousedown", onTooltipClick);
    tooltip.addEventListener("touchstart", onTooltipClick);
    tooltip.addEventListener("mouseleave", onTooltipUnhover);

    // (for interaction with lightbox plugin)
    // transfer click on tooltip copied img to original img
    const sourceImg = source.querySelector("img");
    const sourceCopyImg = sourceCopy.querySelector("img");
    if (sourceImg && sourceCopyImg) {
      const clickImg = function () {
        sourceImg.click();
        closeTooltip();
      };
      sourceCopyImg.addEventListener("click", clickImg);
    }

    return tooltip;
  }

  // make carbon copy of html dom element
  function makeCopy(source) {
    const sourceCopy = source.cloneNode(true);

    // delete elements marked with ignore (eg anchor and jump buttons)
    const deleteFromCopy = sourceCopy.querySelectorAll('[data-ignore="true"]');
    for (const element of deleteFromCopy) element.remove();

    // delete certain element attributes
    const attributes = [
      "id",
      "data-collapsed",
      "data-selected",
      "data-highlighted",
      "data-glow",
    ];
    for (const attribute of attributes) {
      sourceCopy.removeAttribute(attribute);
      const elements = sourceCopy.querySelectorAll("[" + attribute + "]");
      for (const element of elements) element.removeAttribute(attribute);
    }

    return sourceCopy;
  }

  // when tooltip is clicked
  function onTooltipClick(event) {
    // when user clicks on tooltip, stop click from transferring
    // outside of tooltip (eg, click off to close tooltip, or eg click
    // off to unhighlight same refs)
    event.stopPropagation();
  }

  // when tooltip is unhovered
  function onTooltipUnhover(event) {
    if (clickClose === "true") return;

    // make sure new mouse/touch/focus no longer over tooltip or any
    // element within it
    const tooltip = document.getElementById("tooltip");
    if (!tooltip) return;
    if (this.contains(event.relatedTarget)) return;

    closeTooltip();
  }

  // make nav bar to go betwen prev/next instances of same reference
  function makeNavBar(link) {
    // find other links to the same source
    const sameLinks = getSameLinks(link);

    // don't show nav bar when singular reference
    if (sameLinks.total <= 1) return;

    // find prev/next links with same target
    const prevLink = getPrevLink(link, sameLinks);
    const nextLink = getNextLink(link, sameLinks);

    // create nav bar
    const navBar = document.createElement("div");
    navBar.id = "tooltip_nav_bar";
    const text = sameLinks.index + 1 + " of " + sameLinks.total;

    // create nav bar prev/next buttons
    const prevButton = document.createElement("button");
    const nextButton = document.createElement("button");
    prevButton.id = "tooltip_prev_button";
    nextButton.id = "tooltip_next_button";
    prevButton.title =
      "Jump to the previous occurence of this item in the document [←]";
    nextButton.title =
      "Jump to the next occurence of this item in the document [→]";
    prevButton.classList.add("icon_button");
    nextButton.classList.add("icon_button");
    prevButton.innerHTML = document.querySelector(".icon_caret_left").innerHTML;
    nextButton.innerHTML = document.querySelector(
      ".icon_caret_right"
    ).innerHTML;
    navBar.appendChild(prevButton);
    navBar.appendChild(document.createTextNode(text));
    navBar.appendChild(nextButton);

    // attach click listeners to buttons
    prevButton.addEventListener("click", function () {
      onPrevNextClick(link, prevLink);
    });
    nextButton.addEventListener("click", function () {
      onPrevNextClick(link, nextLink);
    });

    return navBar;
  }

  // get previous link with same target
  function getPrevLink(link, sameLinks) {
    if (!sameLinks) sameLinks = getSameLinks(link);
    // wrap index to other side if < 1
    let index;
    if (sameLinks.index - 1 >= 0) index = sameLinks.index - 1;
    else index = sameLinks.total - 1;
    return sameLinks.elements[index];
  }

  // get next link with same target
  function getNextLink(link, sameLinks) {
    if (!sameLinks) sameLinks = getSameLinks(link);
    // wrap index to other side if > total
    let index;
    if (sameLinks.index + 1 <= sameLinks.total - 1) index = sameLinks.index + 1;
    else index = 0;
    return sameLinks.elements[index];
  }

  // get element that is target of link or url hash
  function getSource(link) {
    const hash = link ? link.hash : window.location.hash;
    const id = hash.slice(1);
    let target = document.querySelector('[id="' + id + '"]');
    if (!target) return;

    // if ref or figure, modify target to get expected element
    if (id.indexOf("ref-") === 0) target = target.querySelector("p");
    else if (id.indexOf("fig:") === 0) target = target.querySelector("figure");

    return target;
  }

  // when prev/next arrow button is clicked
  function onPrevNextClick(link, prevNextLink) {
    if (link && prevNextLink)
      goToElement(prevNextLink, window.innerHeight * 0.5);
  }

  // scroll to and focus element
  function goToElement(element, offset) {
    // expand accordion section if collapsed
    expandElement(element);
    const y =
      getRectInView(element).top -
      getRectInView(document.documentElement).top -
      (offset || 0);
    // trigger any function listening for "onscroll" event
    window.dispatchEvent(new Event("scroll"));
    window.scrollTo(0, y);
    document.activeElement.blur();
    element.focus();
  }

  // determine position to place tooltip based on link position in
  // viewport and tooltip size
  function positionTooltip(link, left, top) {
    const tooltipElement = document.getElementById("tooltip");
    if (!tooltipElement) return;

    // get convenient vars for position/dimensions of
    // link/tooltip/page/view
    link = getRectInPage(link);
    const tooltip = getRectInPage(tooltipElement);
    const view = getRectInPage();

    // horizontal positioning
    if (left)
      // use explicit value
      left = left;
    else if (link.left + tooltip.width < view.right)
      // fit tooltip to right of link
      left = link.left;
    else if (link.right - tooltip.width > view.left)
      // fit tooltip to left of link
      left = link.right - tooltip.width;
    // center tooltip in view
    else left = (view.right - view.left) / 2 - tooltip.width / 2;

    // vertical positioning
    if (top)
      // use explicit value
      top = top;
    else if (link.top - tooltip.height > view.top)
      // fit tooltip above link
      top = link.top - tooltip.height;
    else if (link.bottom + tooltip.height < view.bottom)
      // fit tooltip below link
      top = link.bottom;
    else {
      // center tooltip in view
      top = view.top + view.height / 2 - tooltip.height / 2;
      // nudge off of link to left/right if possible
      if (link.right + tooltip.width < view.right) left = link.right;
      else if (link.left - tooltip.width > view.left)
        left = link.left - tooltip.width;
    }

    tooltipElement.style.left = left + "px";
    tooltipElement.style.top = top + "px";
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- caret left icon -->

<template class="icon_caret_left">
  <!-- modified from: https://fontawesome.com/icons/caret-left -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"
    ></path>
  </svg>
</template>

<!-- caret right icon -->

<template class="icon_caret_right">
  <!-- modified from: https://fontawesome.com/icons/caret-right -->
  <svg width="16" height="16" viewBox="0 0 192 512">
    <path
      fill="currentColor"
      d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"
    ></path>
  </svg>
</template>

<style>
  @media only screen {
    /* tooltip container */
    #tooltip {
      position: absolute;
      width: 50%;
      min-width: 240px;
      max-width: 75%;
      z-index: 1;
    }

    /* tooltip content */
    #tooltip_content {
      margin-bottom: 5px;
      padding: 20px;
      border-radius: 5px;
      border: solid 1px #bdbdbd;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
      background: #ffffff;
      overflow-wrap: break-word;
    }

    /* tooltip copy of paragraphs and figures */
    #tooltip_content > p,
    #tooltip_content > figure {
      margin: 0;
      max-height: 320px;
      overflow-y: auto;
    }

    /* tooltip copy of <img> */
    #tooltip_content > figure > img,
    #tooltip_content > figure > svg {
      max-height: 260px;
    }

    /* navigation bar */
    #tooltip_nav_bar {
      margin-top: 10px;
      text-align: center;
    }

    /* navigation bar previous/next buton */
    #tooltip_nav_bar > .icon_button {
      position: relative;
      top: 3px;
    }

    /* navigation bar previous button */
    #tooltip_nav_bar > .icon_button:first-of-type {
      margin-right: 5px;
    }

    /* navigation bar next button */
    #tooltip_nav_bar > .icon_button:last-of-type {
      margin-left: 5px;
    }
  }

  /* always hide tooltip on print */
  @media only print {
    #tooltip {
      display: none;
    }
  }
</style>
<!--
  Analytics Plugin (third-party) 
  
  Copy and paste code from Google Analytics or similar service here.
-->
<!-- 
  Annotations Plugin

  Allows public annotation of the  manuscript. See https://web.hypothes.is/.
-->

<script>
  // configuration
  window.hypothesisConfig = function () {
    return {
      branding: {
        accentColor: "#2196f3",
        appBackgroundColor: "#f8f8f8",
        ctaBackgroundColor: "#f8f8f8",
        ctaTextColor: "#000000",
        selectionFontFamily: "Open Sans, Helvetica, sans serif",
        annotationFontFamily: "Open Sans, Helvetica, sans serif",
      },
    };
  };

  // hypothesis client script
  const embed = "https://hypothes.is/embed.js";
  // hypothesis annotation count query url
  const query = "https://api.hypothes.is/api/search?limit=0&url=";

  // start script
  function start() {
    const button = makeButton();
    document.body.insertBefore(button, document.body.firstChild);
    insertCount(button);
  }

  // make button
  function makeButton() {
    // create button
    const button = document.createElement("button");
    button.id = "hypothesis_button";
    button.innerHTML = document.querySelector(".icon_hypothesis").innerHTML;
    button.title = "Hypothesis annotations";
    button.classList.add("icon_button");

    function onClick(event) {
      onButtonClick(event, button);
    }

    // attach click listeners
    button.addEventListener("click", onClick);

    return button;
  }

  // insert annotations count
  async function insertCount(button) {
    // get annotation count from Hypothesis based on url
    let count = "-";
    try {
      const canonical = document.querySelector('link[rel="canonical"]');
      const location = window.location;
      const url = encodeURIComponent((canonical || location).href);
      const response = await fetch(query + url);
      const json = await response.json();
      count = json.total || "-";
    } catch (error) {
      console.log(error);
    }

    // put count into button
    const counter = document.createElement("span");
    counter.id = "hypothesis_count";
    counter.innerHTML = count;
    button.title = "View " + count + " Hypothesis annotations";
    button.append(counter);
  }

  // when button is clicked
  function onButtonClick(event, button) {
    const script = document.createElement("script");
    script.src = embed;
    document.body.append(script);
    button.remove();
  }

  // start script when document is finished loading
  window.addEventListener("load", start);
</script>

<!-- hypothesis icon -->

<template class="icon_hypothesis">
  <!-- modified from: https://simpleicons.org/icons/hypothesis.svg / https://git.io/Jf1VB -->
  <svg width="16" height="16" viewBox="0 0 24 24" tabindex="-1">
    <path
      fill="currentColor"
      d="M3.43 0C2.5 0 1.72 .768 1.72 1.72V18.86C1.72 19.8 2.5 20.57 3.43 20.57H9.38L12 24L14.62 20.57H20.57C21.5 20.57 22.29 19.8 22.29 18.86V1.72C22.29 .77 21.5 0 20.57 0H3.43M5.14 3.43H7.72V9.43S8.58 7.72 10.28 7.72C12 7.72 13.74 8.57 13.74 11.24V17.14H11.16V12C11.16 10.61 10.28 10.07 9.43 10.29C8.57 10.5 7.72 11.41 7.72 13.29V17.14H5.14V3.43M18 13.72C18.95 13.72 19.72 14.5 19.72 15.42A1.71 1.71 0 0 1 18 17.13A1.71 1.71 0 0 1 16.29 15.42C16.29 14.5 17.05 13.71 18 13.71Z"
      tabindex="-1"
    ></path>
  </svg>
</template>

<style>
  /* hypothesis activation button */
  #hypothesis_button {
    box-sizing: border-box;
    position: fixed;
    top: 0;
    right: 0;
    width: 60px;
    height: 60px;
    background: #ffffff;
    border-radius: 0;
    border-left: solid 1px #bdbdbd;
    border-bottom: solid 1px #bdbdbd;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.05);
    z-index: 2;
  }

  /* hypothesis button svg */
  #hypothesis_button > svg {
    position: relative;
    top: -4px;
  }

  /* hypothesis annotation count */
  #hypothesis_count {
    position: absolute;
    left: 0;
    right: 0;
    bottom: 5px;
  }

  /* side panel */
  .annotator-frame {
    width: 280px !important;
  }

  /* match highlight color to rest of theme */
  .annotator-highlights-always-on .annotator-hl {
    background-color: #ffeb3b !important;
  }

  /* match focused color to rest of theme */
  .annotator-hl.annotator-hl-focused {
    background-color: #ff8a65 !important;
  }

  /* match bucket bar color to rest of theme */
  .annotator-bucket-bar {
    background: #f5f5f5 !important;
  }

  /* always hide button, toolbar, and tooltip on print */
  @media only print {
    #hypothesis_button {
      display: none;
    }

    .annotator-frame {
      display: none !important;
    }

    hypothesis-adder {
      display: none !important;
    }
  }
</style>
<!-- 
  Mathjax Plugin (third-party) 

  Allows the proper rendering of math/equations written in LaTeX.
  See https://www.mathjax.org/.
-->

<script type="text/x-mathjax-config">
  // configuration
  MathJax.Hub.Config({
    "CommonHTML": { linebreaks: { automatic: true } },
    "HTML-CSS": { linebreaks: { automatic: true } },
    "SVG": { linebreaks: { automatic: true } },
    "fast-preview": { disabled: true }
  });
</script>

<script
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
  integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A=="
  crossorigin="anonymous"
></script>

<style>
  /* mathjax containers */
  .math.display > span:not(.MathJax_Preview) {
    /* turn inline element (no dimensions) into block (allows fixed width and thus scrolling) */
    display: flex !important;
    overflow-x: auto !important;
    overflow-y: hidden !important;
    justify-content: center;
    align-items: center;
    margin: 0 !important;
  }

  /* right click menu */
  .MathJax_Menu {
    border-radius: 5px !important;
    border: solid 1px #bdbdbd !important;
    box-shadow: none !important;
  }

  /* equation auto-number */
  span[id^="eq:"] > span.math.display + span {
    font-weight: 600;
  }

  /* equation */
  span[id^="eq:"] > span.math.display > span {
    /* nudge to make room for equation auto-number and anchor */
    margin-right: 60px !important;
  }
</style>
</body>
</html>
